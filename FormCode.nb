(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    180404,       4085]
NotebookOptionsPosition[    172734,       3969]
NotebookOutlinePosition[    173130,       3985]
CellTagsIndexPosition[    173087,       3982]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.861703617931142*^9, 3.8617036196758127`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d1ef815d-3661-4497-8557-0d2a666e40d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.850041773974058*^9, 3.8500417822836037`*^9}, 
   3.86375671445866*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"d729a100-b25e-4533-b309-ff25a82f608c"],

Cell[BoxData["\<\"/home/tom/Uni/Semester_X/master/programs/DiaGenldSolver/\
double_soft\"\>"], "Output",
 CellChangeTimes->{
  3.863756715056478*^9, {3.864125488701304*^9, 3.86412550858657*^9}, 
   3.864127125564269*^9, 3.864183192261282*^9, 3.864353949194536*^9, 
   3.864358894088891*^9, 3.864394826815111*^9, 3.864441119942354*^9, 
   3.864441843875823*^9, {3.8644480423097267`*^9, 3.864448059827612*^9}, 
   3.864466242660523*^9, 3.864535406056157*^9, 3.8647198525377893`*^9, 
   3.864806609377201*^9, 3.8648777171691504`*^9, 3.864959560624042*^9, 
   3.864959614269371*^9, 3.866098765331558*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"39471319-b1c6-4940-a77c-9e75e9c7d406"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"Solve", "::", "svars"}], ",", 
    RowBox[{"General", "::", "compat"}], ",", 
    RowBox[{"SetDelayed", "::", "write"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8519452834098*^9, 3.851945295774857*^9}, {
  3.851946002043087*^9, 3.8519460073037453`*^9}, {3.8522001197248363`*^9, 
  3.852200122970076*^9}, {3.864183194216886*^9, 3.864183197583563*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"565ef35d-b762-4ee2-b85c-81983d97854c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Combinatorica`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8500207026853533`*^9, 3.850020734776175*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"5118d361-6ccf-47e4-84d9-79b511631a74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "PassarinoVeltman.m"}], ";"}]], "Input",
 CellChangeTimes->{{3.85011635607694*^9, 3.850116363179256*^9}, {
   3.850556672119734*^9, 3.850556674915781*^9}, 3.85055873416485*^9, {
   3.850721017237328*^9, 3.850721076085371*^9}, {3.850721175135962*^9, 
   3.850721216952929*^9}, {3.850723534001288*^9, 3.8507235385928183`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"89110cd7-09c9-49e4-8ebd-53ece94cf413"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Simple tool for Passarino-Veltman reduction\"\>"], "Print",
 CellChangeTimes->{
  3.850721076393668*^9, 3.850721134598312*^9, {3.85072119286579*^9, 
   3.850721217428273*^9}, 3.8507226940507193`*^9, 3.850722942616247*^9, 
   3.850723545519773*^9, 3.8508304021711187`*^9, 3.850830498733789*^9, 
   3.850830772983268*^9, 3.85139586958302*^9, 3.851945980154777*^9, 
   3.8519472045469112`*^9, 3.852200128854985*^9, 3.852200813759276*^9, 
   3.852201916803441*^9, 3.85224906444355*^9, 3.85224914321876*^9, 
   3.852249351539274*^9, 3.8522595166739902`*^9, 3.85226003885893*^9, 
   3.8522602442914343`*^9, 3.852277033988935*^9, 3.852278872273438*^9, 
   3.8522796207479258`*^9, 3.8524332951436234`*^9, 3.852434310458824*^9, 
   3.852435849528788*^9, 3.852435945411559*^9, 3.852436095037436*^9, 
   3.852436363068486*^9, 3.853044011233111*^9, 3.861704055890251*^9, 
   3.861705269222004*^9, 3.8617055622182426`*^9, 3.861718373192236*^9, 
   3.863231204814651*^9, 3.863756641548877*^9, 3.8637567211908503`*^9, 
   3.864125518559269*^9, 3.8641271320818253`*^9, 3.86418320158036*^9, 
   3.864353956674335*^9, 3.864358900198492*^9, 3.8643948336005983`*^9, 
   3.8644411271658983`*^9, 3.864441856462384*^9, {3.864448049738203*^9, 
   3.864448064799161*^9}, 3.864466249637154*^9, 3.8645354127682943`*^9, 
   3.8647198587918987`*^9, 3.864806615043397*^9, 3.8648777239359207`*^9, 
   3.86495957058447*^9, 3.864959621544766*^9, 3.8660987749944563`*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"c1063591-7d66-411c-93f2-b1e03d434f77"],

Cell[BoxData["\<\"M. Czakon, 13 Oct 12\"\>"], "Print",
 CellChangeTimes->{
  3.850721076393668*^9, 3.850721134598312*^9, {3.85072119286579*^9, 
   3.850721217428273*^9}, 3.8507226940507193`*^9, 3.850722942616247*^9, 
   3.850723545519773*^9, 3.8508304021711187`*^9, 3.850830498733789*^9, 
   3.850830772983268*^9, 3.85139586958302*^9, 3.851945980154777*^9, 
   3.8519472045469112`*^9, 3.852200128854985*^9, 3.852200813759276*^9, 
   3.852201916803441*^9, 3.85224906444355*^9, 3.85224914321876*^9, 
   3.852249351539274*^9, 3.8522595166739902`*^9, 3.85226003885893*^9, 
   3.8522602442914343`*^9, 3.852277033988935*^9, 3.852278872273438*^9, 
   3.8522796207479258`*^9, 3.8524332951436234`*^9, 3.852434310458824*^9, 
   3.852435849528788*^9, 3.852435945411559*^9, 3.852436095037436*^9, 
   3.852436363068486*^9, 3.853044011233111*^9, 3.861704055890251*^9, 
   3.861705269222004*^9, 3.8617055622182426`*^9, 3.861718373192236*^9, 
   3.863231204814651*^9, 3.863756641548877*^9, 3.8637567211908503`*^9, 
   3.864125518559269*^9, 3.8641271320818253`*^9, 3.86418320158036*^9, 
   3.864353956674335*^9, 3.864358900198492*^9, 3.8643948336005983`*^9, 
   3.8644411271658983`*^9, 3.864441856462384*^9, {3.864448049738203*^9, 
   3.864448064799161*^9}, 3.864466249637154*^9, 3.8645354127682943`*^9, 
   3.8647198587918987`*^9, 3.864806615043397*^9, 3.8648777239359207`*^9, 
   3.86495957058447*^9, 3.864959621544766*^9, 3.866098774997591*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"662d13d9-2ec9-41e4-bc42-0026ac81c8a7"],

Cell[BoxData["\<\"Type ?ReduceTensor for documentation\"\>"], "Print",
 CellChangeTimes->{
  3.850721076393668*^9, 3.850721134598312*^9, {3.85072119286579*^9, 
   3.850721217428273*^9}, 3.8507226940507193`*^9, 3.850722942616247*^9, 
   3.850723545519773*^9, 3.8508304021711187`*^9, 3.850830498733789*^9, 
   3.850830772983268*^9, 3.85139586958302*^9, 3.851945980154777*^9, 
   3.8519472045469112`*^9, 3.852200128854985*^9, 3.852200813759276*^9, 
   3.852201916803441*^9, 3.85224906444355*^9, 3.85224914321876*^9, 
   3.852249351539274*^9, 3.8522595166739902`*^9, 3.85226003885893*^9, 
   3.8522602442914343`*^9, 3.852277033988935*^9, 3.852278872273438*^9, 
   3.8522796207479258`*^9, 3.8524332951436234`*^9, 3.852434310458824*^9, 
   3.852435849528788*^9, 3.852435945411559*^9, 3.852436095037436*^9, 
   3.852436363068486*^9, 3.853044011233111*^9, 3.861704055890251*^9, 
   3.861705269222004*^9, 3.8617055622182426`*^9, 3.861718373192236*^9, 
   3.863231204814651*^9, 3.863756641548877*^9, 3.8637567211908503`*^9, 
   3.864125518559269*^9, 3.8641271320818253`*^9, 3.86418320158036*^9, 
   3.864353956674335*^9, 3.864358900198492*^9, 3.8643948336005983`*^9, 
   3.8644411271658983`*^9, 3.864441856462384*^9, {3.864448049738203*^9, 
   3.864448064799161*^9}, 3.864466249637154*^9, 3.8645354127682943`*^9, 
   3.8647198587918987`*^9, 3.864806615043397*^9, 3.8648777239359207`*^9, 
   3.86495957058447*^9, 3.864959621544766*^9, 3.866098775002537*^9},
 CellLabel->
  "During evaluation of \
In[4]:=",ExpressionUUID->"dd6d5ec4-7a94-4ad9-a4dd-c10f782b5879"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definitions", "Section",
 CellChangeTimes->{{3.851945523804715*^9, 
  3.851945526493454*^9}},ExpressionUUID->"bb4022c5-ce3d-4c48-b7bc-\
92147fd4273f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"momenta", "=", 
   RowBox[{"{", 
    RowBox[{"p3", ",", " ", "p4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scalars", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "^", "2"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"p1", "^", "2"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"p2", "^", "2"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"p3", "^", "2"}], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"p4", "^", "2"}], "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"p1", " ", "p2"}], "\[Rule]", 
      RowBox[{"s12", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"p1", " ", "p3"}], "\[Rule]", 
      RowBox[{"s13", "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"p1", " ", "p4"}], " ", "\[Rule]", " ", 
      RowBox[{"s14", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"p2", " ", "p3"}], "\[Rule]", 
      RowBox[{"s23", "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"p2", " ", "p4"}], " ", "\[Rule]", " ", 
      RowBox[{"s24", "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"p3", " ", "p4"}], " ", "\[Rule]", " ", 
      RowBox[{"s34", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"n", ",", "n"}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p1", ",", "p1"}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p2", ",", "p2"}], "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p3", ",", "p3"}], "]"}], "\[Rule]", "0"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p4", ",", " ", "p4"}], "]"}], " ", "\[Rule]", " ", "0"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p1", ",", "p2"}], "]"}], "\[Rule]", 
      RowBox[{"s12", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p1", ",", "p3"}], "]"}], "\[Rule]", 
      RowBox[{"s13", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p1", ",", " ", "p4"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"s14", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p2", ",", "p3"}], "]"}], "\[Rule]", 
      RowBox[{"s23", "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p2", ",", " ", "p4"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"s24", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p3", ",", " ", "p4"}], "]"}], "\[Rule]", " ", 
      RowBox[{"s34", "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p12", ",", "p12"}], "]"}], "\[Rule]", "s12"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p13", ",", "p13"}], "]"}], "\[Rule]", "s13"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p14", ",", "p14"}], "]"}], " ", "\[Rule]", " ", "s14"}], ",", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p23", ",", "p23"}], "]"}], "\[Rule]", "s23"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p24", ",", " ", "p24"}], "]"}], " ", "\[Rule]", " ", "s24"}], 
     ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p34", ",", " ", "p34"}], "]"}], " ", "\[Rule]", " ", "s34"}], 
     ",", 
     RowBox[{
      RowBox[{"s", "[", 
       RowBox[{"p123", ",", "p123"}], "]"}], "\[Rule]", "s123"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p124", ",", " ", "p124"}], "]"}], " ", "\[Rule]", " ", 
      "s124"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p134", ",", " ", "p134"}], "]"}], " ", "\[Rule]", " ", 
      "s134"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p234", ",", " ", "p234"}], "]"}], " ", "\[Rule]", " ", 
      "s234"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p13", ",", "p2"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s12", "+", "s23"}], ")"}], "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p14", ",", " ", "p2"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s12", " ", "+", " ", "s24"}], ")"}], "/", "2"}]}], " ", ",", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p12", ",", "p3"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s13", "+", "s23"}], ")"}], "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p23", ",", "p1"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s12", "+", "s13"}], ")"}], "/", "2"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p12", ",", " ", "p4"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s14", " ", "+", " ", "s24"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p13", ",", " ", "p4"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s14", " ", "+", " ", "s34"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p14", ",", " ", "p3"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s14", " ", "+", " ", "s34"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p24", ",", " ", "p1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s12", " ", "+", " ", "s14"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p24", ",", " ", "p3"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s23", " ", "+", " ", "s34"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p34", ",", " ", "p1"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s13", " ", "+", " ", "s14"}], ")"}], "/", "2"}]}], ",", " ", 
     
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p34", ",", " ", "p2"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"s23", " ", "+", " ", "s24"}], ")"}], "/", "2"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p123", ",", "p123"}], "]"}], "\[Rule]", 
      RowBox[{"s12", "+", "s13", "+", "s23"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p124", ",", " ", "p124"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"s12", " ", "+", " ", "s14", " ", "+", " ", "s24"}], ")"}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p134", ",", " ", "p134"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"s13", " ", "+", " ", "s14", " ", "+", " ", "s34"}], ")"}]}], 
     ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p234", ",", " ", "p234"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"(", 
       RowBox[{"s23", " ", "+", " ", "s24", " ", "+", " ", "s34"}], ")"}]}], 
     ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p1", ",", "n"}], "]"}], "\[Rule]", "p1n"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p2", ",", "n"}], "]"}], "\[Rule]", "p2n"}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p3", ",", "n"}], "]"}], "\[Rule]", "p3n"}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p4", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", "p4n"}], 
     ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", "+", "p2"}], ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p2n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", "+", "p3"}], ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p3n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p2", "+", "p3"}], ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p2n", "+", "p3n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", " ", "+", " ", "p4"}], ",", " ", "n"}], "]"}], " ", 
      "\[Rule]", " ", 
      RowBox[{"p1n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p2", " ", "+", " ", "p4"}], ",", "n"}], "]"}], " ", 
      "\[Rule]", " ", 
      RowBox[{"p2n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p3", " ", "+", " ", "p4"}], ",", "n"}], "]"}], " ", 
      "\[Rule]", " ", 
      RowBox[{"p3n", " ", "+", " ", "p4n"}]}], " ", ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", "+", "p2", "+", "p3"}], ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p2n", "+", "p3n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", " ", "+", " ", "p2", " ", "+", " ", "p4"}], ",", " ", 
        "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p1n", " ", "+", " ", "p2n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p1", " ", "+", " ", "p3", " ", "+", " ", "p4"}], ",", "n"}], 
       "]"}], " ", "\[Rule]", "  ", 
      RowBox[{"p1n", " ", "+", " ", "p3n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{
        RowBox[{"p2", " ", "+", " ", "p3", " ", "+", " ", "p4"}], ",", " ", 
        "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p2n", " ", "+", " ", "p3n", " ", "+", " ", "p4n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p12", ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p2n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p13", ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p3n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p23", ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p2n", "+", "p3n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p14", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p1n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p24", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p2n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p34", ",", "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p3n", " ", "+", " ", "p4n"}]}], ",", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p123", ",", "n"}], "]"}], "\[Rule]", 
      RowBox[{"p1n", "+", "p2n", "+", "p3n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p124", ",", " ", "n"}], "]"}], "\[Rule]", " ", 
      RowBox[{"p1n", " ", "+", " ", "p2n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p134", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p1n", " ", "+", " ", "p2n", " ", "+", " ", "p4n"}]}], ",", " ", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"p234", ",", " ", "n"}], "]"}], " ", "\[Rule]", " ", 
      RowBox[{"p2n", " ", "+", " ", "p3n", " ", "+", " ", "p4n"}]}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.850053068903866*^9, 3.850053074436788*^9}, {
   3.8500531403807163`*^9, 3.850053152247857*^9}, {3.8501129771603327`*^9, 
   3.8501129852848997`*^9}, {3.8501164602330723`*^9, 3.850116471847156*^9}, {
   3.850116945958212*^9, 3.850116995905621*^9}, {3.85011733077752*^9, 
   3.850117353663395*^9}, {3.8502035714049683`*^9, 3.850203604491337*^9}, {
   3.850204580187286*^9, 3.85020469252767*^9}, 3.8502049797009087`*^9, {
   3.850205109269575*^9, 3.850205126625318*^9}, {3.8502051638085537`*^9, 
   3.850205168486597*^9}, {3.850217554261427*^9, 3.850217674438179*^9}, {
   3.8503010890200167`*^9, 3.850301170136611*^9}, {3.85030126769103*^9, 
   3.850301279624576*^9}, {3.850301372902776*^9, 3.8503013729809628`*^9}, {
   3.8503070811683598`*^9, 3.850307087951807*^9}, 3.851946722685845*^9, {
   3.85194678889396*^9, 3.8519467995611057`*^9}, {3.8519469688767567`*^9, 
   3.851946970141862*^9}, {3.851947081154711*^9, 3.851947102149094*^9}, {
   3.851947136439794*^9, 3.851947151261447*^9}, {3.861703695247573*^9, 
   3.861703718131353*^9}, {3.863231116794694*^9, 3.863231118189961*^9}, {
   3.863756621141087*^9, 3.863756623389471*^9}, {3.86376597287851*^9, 
   3.863765975027223*^9}, {3.864124033139853*^9, 3.864124034432886*^9}, {
   3.8641241368682528`*^9, 3.8641242501081467`*^9}, {3.864124601361961*^9, 
   3.864124784668354*^9}, {3.8641248620798597`*^9, 3.864125448629684*^9}, {
   3.864448092463381*^9, 3.864448094695183*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"cc9e95fe-805b-4206-b3b9-5b90da03658e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FORMString", "[", "expr_", "]"}], ":=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"StringReplace", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"expr", "/.", 
          RowBox[{
           RowBox[{"S", "[", 
            RowBox[{"p1_", ",", "p2_"}], "]"}], "\[Rule]", 
           RowBox[{"p1", ".", "p2"}]}]}], ",", "InputForm"}], "]"}], ",", 
       RowBox[{"Whitespace", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<g[\>\"", "\[Rule]", "\"\<d_(\>\""}], ",", 
       RowBox[{"\"\<[\>\"", "\[Rule]", "\"\<(\>\""}], ",", 
       RowBox[{"\"\<]\>\"", "\[Rule]", "\"\<)\>\""}], ",", " ", 
       RowBox[{"\"\<\\\"\>\"", " ", "\[Rule]", " ", "\"\<\>\""}]}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.850016113259904*^9, 3.8500161623694897`*^9}, {
   3.850016233223269*^9, 3.8500162567942753`*^9}, {3.850117110399755*^9, 
   3.8501171173909082`*^9}, {3.850203757699362*^9, 3.850203795038218*^9}, {
   3.850203979065394*^9, 3.8502040191387157`*^9}, {3.850388050264831*^9, 
   3.8503880573031807`*^9}, 3.850388298888715*^9, {3.864183449970402*^9, 
   3.864183463333282*^9}, {3.864183881362678*^9, 3.864183883722348*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"29dd5750-5c61-4b69-b034-3ddba8e42fcd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Integrand normalization code: form/Integrands{2,3,4}liners.prc\
\>", "Section",
 CellChangeTimes->{{3.850053088440531*^9, 3.850053097988784*^9}, {
   3.851945550864794*^9, 3.85194556433418*^9}, {3.851945696783215*^9, 
   3.851945706391095*^9}, {3.851945756654402*^9, 3.851945758553514*^9}, 
   3.851945872654347*^9, {3.8522597282074413`*^9, 
   3.852259734569128*^9}},ExpressionUUID->"7dbbcaa8-da25-447e-93d7-\
6616b8f5b7de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"replace1ce", "=", 
   RowBox[{
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"$done", "=", "False"}], "}"}], ",", 
      RowBox[{"Fold", "[", 
       RowBox[{"ReplaceAll", ",", "#", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[RuleDelayed]", 
           RowBox[{"RuleCondition", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"$done", "=", "True"}], ";", "#2"}], ",", 
             RowBox[{"!", "$done"}]}], "]"}]}], "&"}], "@@@", "#2"}]}], 
       "]"}]}], "]"}], "&"}]}], ";"}]], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"8614b129-7024-42f4-ae6e-d11089432f07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeIntegrandNormalizationCode", "[", 
   RowBox[{
   "filename_", ",", "multiplicity_Integer", ",", " ", "DSmin_Integer", ",", 
    " ", "DSmax_Integer"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "file", ",", "externalMomentumConfigurations", ",", "propList", ",", 
      "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"file", "=", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{"\"\<form/\>\"", "<>", "filename"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#procedure \>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"filename", ",", 
         RowBox[{"\"\<.prc\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", 
       RowBox[{"\"\<* Generated by \>\"", "<>", 
        RowBox[{"FileNameTake", "[", 
         RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
        "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<b DS,Eik,k;\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<.sort\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<Keep Brackets;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{
         "file", ",", "\"\<elseif ((count(DS,1) == \>\"", ",", "j", ",", 
          "\"\<) && (count(Eik,1) == \>\"", ",", 
          RowBox[{"multiplicity", " ", "-", " ", "j"}], ",", 
          "\"\<));\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"propList", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"DS", ",", "j"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"Eik", ",", " ", 
             RowBox[{"multiplicity", " ", "-", "j"}]}], "]"}]}], "]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"writeIntegrandNormalizationCodeSingle", "[", 
         RowBox[{"file", ",", "propList"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "DSmin", ",", "DSmax"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<endif;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<.sort\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#call Kinematics\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#call NormalizePropagators\\n\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#endprocedure\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "file", "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850039841202075*^9, 3.8500399101069803`*^9}, {
   3.8500399969294357`*^9, 3.8500401203673277`*^9}, {3.850040971404728*^9, 
   3.850041044404405*^9}, {3.850041278337599*^9, 3.850041278405116*^9}, {
   3.850052501861404*^9, 3.850052506580406*^9}, {3.850052581473525*^9, 
   3.850052581600795*^9}, {3.850052662606402*^9, 3.850052662739266*^9}, {
   3.8500535839281588`*^9, 3.8500537634363728`*^9}, {3.85005394252284*^9, 
   3.850053945495902*^9}, {3.850054063456952*^9, 3.850054064323885*^9}, 
   3.8500541075293922`*^9, {3.850054265009696*^9, 3.850054282097746*^9}, {
   3.850089171128887*^9, 3.850089209633469*^9}, {3.850110333391786*^9, 
   3.850110340010284*^9}, 3.8501163196783667`*^9, {3.850446896480377*^9, 
   3.8504469001072197`*^9}, {3.850486586886633*^9, 3.8504865976912394`*^9}, {
   3.850487015524631*^9, 3.850487067532535*^9}, {3.850487178157996*^9, 
   3.850487181285007*^9}, {3.8504872872679243`*^9, 3.850487291378621*^9}, {
   3.850560498070157*^9, 3.8505605167848673`*^9}, 3.8505606464957542`*^9, {
   3.8505607836746473`*^9, 3.850560827352556*^9}, {3.850566293069056*^9, 
   3.8505663275431223`*^9}, {3.863759547685103*^9, 3.86375958023307*^9}, {
   3.8637600098061333`*^9, 3.8637600198455133`*^9}, {3.863760126503104*^9, 
   3.863760138237433*^9}, {3.863760600224525*^9, 3.863760639175622*^9}, {
   3.863760705523278*^9, 3.863760706407345*^9}, {3.863764279369836*^9, 
   3.863764318442651*^9}, {3.863764356782789*^9, 3.863764371472871*^9}, {
   3.863764443071143*^9, 3.863764539329543*^9}, {3.863764587629271*^9, 
   3.863764588939909*^9}, 3.863764731537624*^9, {3.8637672214037743`*^9, 
   3.863767226285523*^9}, {3.863767370909525*^9, 3.863767372113648*^9}, {
   3.864353641296824*^9, 3.864353663944889*^9}, {3.8643536963251343`*^9, 
   3.864353730813404*^9}, {3.864353768906618*^9, 3.864353786353483*^9}, {
   3.8643538413109837`*^9, 3.864353905099593*^9}, {3.864354029864872*^9, 
   3.864354035720995*^9}, {3.864354071741403*^9, 3.86435408342628*^9}, {
   3.8643542322221613`*^9, 3.864354232569675*^9}, {3.8643542869778767`*^9, 
   3.864354288808606*^9}, {3.864355816331558*^9, 3.864355857657817*^9}, {
   3.8643569712540417`*^9, 3.864356997017467*^9}, {3.864357084824049*^9, 
   3.86435709894459*^9}, {3.8643572394777803`*^9, 3.864357245153576*^9}, {
   3.864357414763959*^9, 3.864357428863255*^9}, {3.864358690529066*^9, 
   3.864358697180842*^9}, {3.864358771192171*^9, 3.864358811536069*^9}, {
   3.864359086060363*^9, 3.8643590935227222`*^9}, {3.864364422437995*^9, 
   3.864364423961337*^9}, {3.864364839162836*^9, 3.864364844404744*^9}, {
   3.8643729254981613`*^9, 3.86437292602274*^9}, {3.864373576299882*^9, 
   3.864373576662363*^9}, {3.8643742566785603`*^9, 3.864374256889777*^9}, {
   3.864375979515316*^9, 3.864375979771023*^9}, {3.8643776249627047`*^9, 
   3.864377625184677*^9}, {3.8643827535445347`*^9, 3.864382753831661*^9}, {
   3.8643828751283197`*^9, 3.8643828760407867`*^9}, {3.8643833509583693`*^9, 
   3.8643833565662737`*^9}, {3.864383687108388*^9, 3.864383714595673*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"9ce4f695-9c2f-461d-bb30-0b7b4a80cfd6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeIntegrandNormalizationCodeSingle", "[", 
   RowBox[{"file_", ",", " ", "propList_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "momentumSums", ",", " ", "DSmoms", ",", " ", "Eikmoms", ",", 
      "normalIntegrands", ",", " ", "normalIntegrand", ",", " ", 
      "perfectIntegrands", ",", " ", "shiftedIntegrandLeft", ",", " ", 
      "shiftedIntegrandRight", ",", " ", "usedDSmoms", ",", " ", 
      "usedEikmoms", ",", " ", "shifts", ",", "i", ",", "j", ",", "l", ",", 
      " ", "bool", ",", " ", "list"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"momentumSums", "=", 
      RowBox[{"{", 
       RowBox[{"0", ",", "p3", ",", " ", "p4", ",", " ", 
        RowBox[{"p3", "+", "p4"}], ",", " ", 
        RowBox[{"-", "p3"}], ",", " ", 
        RowBox[{"-", "p4"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "p3"}], "-", "p4"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"DSmoms", " ", "=", " ", 
      RowBox[{"Subsets", "[", 
       RowBox[{"momentumSums", ",", 
        RowBox[{"{", 
         RowBox[{"Count", "[", 
          RowBox[{"propList", ",", " ", "DS"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", " ", "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", " ", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "DSmoms", "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"DSmoms", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"l", " ", "=", " ", 
            RowBox[{"j", " ", "+", " ", "1"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"l", " ", "\[LessEqual]", " ", 
              RowBox[{"Length", "[", 
               RowBox[{"DSmoms", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], ",", " ", 
                  "\"\<2\>\""}], "]"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Coefficient", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", "p3", ",", 
                    "1"}], "]"}], " ", "===", " ", 
                  RowBox[{"-", 
                   RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", "p4", ",", 
                    "1"}], "]"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"DSmoms", " ", "=", " ", 
                 RowBox[{"Delete", "[", 
                  RowBox[{"DSmoms", ",", " ", "i"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", 
                  "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"j", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", 
                  "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"i", " ", "=", " ", 
                 RowBox[{"i", " ", "-", " ", "1"}]}], ";"}], ",", " ", 
               RowBox[{
                RowBox[{"l", " ", "=", " ", 
                 RowBox[{"l", "+", " ", "1"}]}], ";"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"j", "+", "1"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"Length", "[", "momentumSums", "]"}], "+", 
           RowBox[{"Count", "[", 
            RowBox[{"propList", ",", "Eik"}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Count", "[", 
          RowBox[{"propList", ",", "Eik"}], "]"}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"Eikmoms", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Subtract", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Count", "[", 
            RowBox[{"propList", ",", "Eik"}], "]"}], "]"}]}], "]"}], "&"}], "/@",
        "list"}]}], ";", "\n", 
     RowBox[{"Eikmoms", " ", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"momentumSums", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "Eikmoms"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", " ", "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", " ", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "Eikmoms", "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"Eikmoms", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"l", " ", "=", " ", 
            RowBox[{"j", " ", "+", " ", "1"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{"l", " ", "\[LessEqual]", " ", 
              RowBox[{"Length", "[", 
               RowBox[{"Eikmoms", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], "]"}], ",", " ", 
                  "\"\<2\>\""}], "]"}], " ", "||", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", "p3", ",", 
                    "1"}], "]"}], " ", "===", " ", 
                    RowBox[{"-", 
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", "p4", ",", 
                    "1"}], "]"}]}]}], ")"}], " ", "&&", " ", 
                  RowBox[{"!", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", "l", "]"}], "]"}]}], ",", " ", "p3", ",", 
                    "1"}], "]"}], " ", "===", "0"}], ")"}]}]}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Eikmoms", " ", "=", " ", 
                 RowBox[{"Delete", "[", 
                  RowBox[{"Eikmoms", ",", " ", "i"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"l", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", 
                  "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"j", " ", "=", " ", 
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "+", " ", 
                  "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"i", " ", "=", " ", 
                 RowBox[{"i", " ", "-", " ", "1"}]}], ";"}], ",", " ", 
               RowBox[{
                RowBox[{"l", " ", "=", " ", 
                 RowBox[{"l", "+", " ", "1"}]}], ";"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"j", "+", "1"}]}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"normalIntegrands", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"normalIntegrand", " ", "=", " ", "1"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"usedDSmoms", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"normalIntegrand", " ", "=", " ", 
              RowBox[{"normalIntegrand", " ", "*", " ", 
               RowBox[{
                RowBox[{"propList", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], " ", "/@", 
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"k", " ", "+", " ", 
                   RowBox[{
                    RowBox[{"DSmoms", "[", 
                    RowBox[{"[", "a", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ")"}]}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"usedDSmoms", ",", 
               RowBox[{
                RowBox[{"DSmoms", "[", 
                 RowBox[{"[", "a", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Count", "[", 
               RowBox[{"propList", ",", " ", "DS"}], "]"}]}], "  ", "}"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"usedEikmoms", " ", "=", " ", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"normalIntegrand", " ", "=", " ", 
              RowBox[{"normalIntegrand", " ", "*", " ", 
               RowBox[{
                RowBox[{"propList", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", " ", "+", " ", 
                   RowBox[{"Count", "[", 
                    RowBox[{"propList", ",", " ", "DS"}], "]"}]}], "]"}], 
                 "]"}], "/@", 
                RowBox[{"(", 
                 RowBox[{"{", 
                  RowBox[{"k", " ", "+", " ", 
                   RowBox[{
                    RowBox[{"Eikmoms", "[", 
                    RowBox[{"[", "b", "]"}], "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ")"}]}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"usedEikmoms", ",", 
               RowBox[{
                RowBox[{"Eikmoms", "[", 
                 RowBox[{"[", "b", "]"}], "]"}], "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Count", "[", 
               RowBox[{"propList", ",", " ", "Eik"}], "]"}]}], "}"}]}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"bool", " ", "=", " ", "True"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bool", " ", "=", " ", 
               RowBox[{"bool", " ", "&&", 
                RowBox[{"!", 
                 RowBox[{"StringContainsQ", "[", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"usedDSmoms", "[", 
                    RowBox[{"[", "m", "]"}], "]"}], " ", "-", " ", 
                    RowBox[{"usedEikmoms", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], "]"}], ",", 
                   "\"\<2\>\""}], "]"}]}]}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"m", ",", "1", ",", 
                RowBox[{"Length", "[", "usedDSmoms", "]"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "1", ",", 
              RowBox[{"Length", "[", "usedEikmoms", "]"}]}], "}"}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"bool", ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"normalIntegrands", ",", " ", "normalIntegrand"}], 
             "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", " ", "1", ",", " ", 
           RowBox[{"Length", "[", "DSmoms", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "Eikmoms", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"shifts", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "k"}], "-", "p3", "-", "p4"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "k"}], "-", "p3"}], ",", " ", 
        RowBox[{
         RowBox[{"-", "k"}], "-", "p4"}], ",", " ", 
        RowBox[{"k", "+", "p4"}], ",", " ", 
        RowBox[{"k", "+", "p3"}], ",", " ", 
        RowBox[{"k", "+", "p3", "+", "p4"}], ",", " ", 
        RowBox[{"k", "-", "p3", "+", "p4"}], ",", 
        RowBox[{"k", "+", "p3", "-", "p4"}], ",", 
        RowBox[{
         RowBox[{"-", "k"}], "-", "p3", "+", "p4"}], ",", 
        RowBox[{
         RowBox[{"-", "k"}], "+", "p3", "-", "p4"}], ",", 
        RowBox[{
         RowBox[{"-", "k"}], "+", "p3", "+", "p4"}], ",", " ", 
        RowBox[{"k", " ", "-", " ", "p3", "-", "p4"}], ",", 
        RowBox[{
         RowBox[{"-", "k"}], "+", "p4"}], ",", 
        RowBox[{
         RowBox[{"-", "k"}], "+", "p3"}], ",", 
        RowBox[{"k", "-", "p3"}], ",", 
        RowBox[{"k", "-", "p4"}], ",", " ", 
        RowBox[{"-", "k"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", " ", "=", " ", "1"}], ";", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i", "<=", 
           RowBox[{"Length", "[", "normalIntegrands", "]"}]}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"Delete", "[", 
               RowBox[{"normalIntegrands", ",", "i"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"normalIntegrands", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "/.", 
                RowBox[{"{", 
                 RowBox[{"k", "\[Rule]", " ", 
                  RowBox[{"shifts", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DS", "[", 
                   RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                  "\[Rule]", " ", 
                  RowBox[{"DS", "[", 
                   RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"DS", "[", 
                   RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                  RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                  "\[Rule]", " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                  RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"normalIntegrands", " ", "=", 
              RowBox[{"Delete", "[", 
               RowBox[{"normalIntegrands", ",", " ", "i"}], "]"}]}], ";"}], 
            ",", " ", 
            RowBox[{"i", " ", "=", " ", 
             RowBox[{"i", "+", "1"}]}]}], "]"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "shifts", "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"perfectIntegrands", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "normalIntegrands", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "shifts", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"normalIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"DS", "[", "k", "]"}]}], "]"}], " ", "===", "1"}], 
              " ", "&&", "\[IndentingNewLine]", " ", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"normalIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"DS", "[", 
                  RowBox[{"k", " ", "-", " ", "p3"}], "]"}]}], "]"}], " ", "===",
                "0"}], "&&", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"normalIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"DS", "[", 
                  RowBox[{"k", " ", "-", " ", "p4"}], "]"}]}], "]"}], " ", "===",
                "0"}], " ", "&&", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Count", "[", 
                RowBox[{
                 RowBox[{"First", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"normalIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"Eik", "[", 
                  RowBox[{"k", "-", "p4", "+", "p3"}], "]"}]}], "]"}], " ", "===",
                "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"perfectIntegrands", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"normalIntegrands", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"i", " ", "=", " ", 
               RowBox[{"i", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
              RowBox[{"j", " ", "=", " ", 
               RowBox[{
                RowBox[{"Length", "[", "shifts", "]"}], "+", "1"}]}], ";"}]}],
             "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", " ", "===", 
              RowBox[{"Length", "[", "shifts", "]"}]}], " ", ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"perfectIntegrands", ",", " ", 
                RowBox[{"normalIntegrands", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"i", " ", "=", " ", 
               RowBox[{"i", " ", "+", " ", "1"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"j", " ", "=", " ", 
               RowBox[{
                RowBox[{"Length", "[", "shifts", "]"}], "+", "1"}]}], ";"}]}],
             "]"}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"j", "+", "1"}]}], ";"}]}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"shiftedIntegrands", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"momshifts", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"i", " ", "=", " ", "1"}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"i", " ", "\[LessEqual]", " ", 
        RowBox[{"Length", "[", "perfectIntegrands", "]"}]}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"j", " ", "=", " ", "1"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"ishift", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"imomshifts", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"j", " ", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "shifts", "]"}]}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"StringContainsQ", "[", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"perfectIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Eik", "[", "k_", "]"}], "2"], "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Eik", "[", "k_", "]"}], "3"], " ", "\[Rule]", 
                    " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"Eik", "[", "k_", "]"}], "4"], " ", "\[Rule]", 
                    " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], "]"}], ",", 
                  " ", "\"\<2\>\""}], "]"}]}], ")"}], "&&", " ", 
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"perfectIntegrands", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                    RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}], " ", ")"}], "===",
                  "  ", 
                 RowBox[{"perfectIntegrands", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"ishift", ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"perfectIntegrands", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "/.", 
                  RowBox[{"{", 
                   RowBox[{"k", "\[Rule]", " ", 
                    RowBox[{"shifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "/.", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"DS", "[", 
                    RowBox[{"k", " ", "-", "p"}], "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"DS", "[", 
                    RowBox[{"-", "k"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"DS", "[", "k", "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{
                    RowBox[{"-", "k"}], " ", "+", " ", "p_"}], "]"}], " ", 
                    "\[Rule]", " ", 
                    RowBox[{"Eik", "[", 
                    RowBox[{"k", " ", "-", " ", "p"}], "]"}]}], ",", " ", 
                   RowBox[{
                    RowBox[{"Eik", "[", 
                    RowBox[{"-", "k_"}], "]"}], " ", "\[Rule]", " ", 
                    RowBox[{"Eik", "[", "k", "]"}]}]}], "}"}]}]}], "]"}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"imomshifts", ",", " ", 
                RowBox[{"shifts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"j", " ", "=", " ", 
            RowBox[{"j", "+", " ", "1"}]}], ";"}]}], " ", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"shiftedIntegrands", ",", " ", "ishift"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"momshifts", ",", " ", "imomshifts"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"i", " ", "=", " ", 
         RowBox[{"i", "+", "1"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"WriteString", "[", 
         RowBox[{"file", ",", "\"\<\\n* \>\"", ",", 
          RowBox[{"FORMString", "[", 
           RowBox[{"First", "[", 
            RowBox[{"perfectIntegrands", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
          "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"shiftedIntegrandLeft", " ", "=", " ", 
            RowBox[{"First", "[", 
             RowBox[{
              RowBox[{"shiftedIntegrands", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"shiftedIntegrandRight", "=", 
            RowBox[{"First", "[", 
             RowBox[{
              RowBox[{"shiftedIntegrands", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"shiftedIntegrandLeft", " ", "=", " ", 
              RowBox[{"replace1ce", "[", 
               RowBox[{"shiftedIntegrandLeft", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Eik", "[", "k_", "]"}], " ", "\[Rule]", " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", " ", 
                    RowBox[{"\"\<r\>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", "l", "]"}], " ", "<>", " ", 
                    "\"\<?\>\""}]}], "]"}]}], "}"}]}], "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "1", ",", " ", 
               RowBox[{"Count", "[", 
                RowBox[{"propList", ",", " ", "Eik"}], "]"}]}], "}"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"shiftedIntegrandRight", "=", " ", 
              RowBox[{"replace1ce", "[", 
               RowBox[{"shiftedIntegrandRight", ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Eik", "[", "k_", "]"}], " ", "\[Rule]", " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", " ", 
                    RowBox[{"\"\<r\>\"", " ", "<>", " ", 
                    RowBox[{"ToString", "[", "l", "]"}]}]}], "]"}]}], "}"}]}],
                "]"}]}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"l", ",", " ", "1", ",", " ", 
               RowBox[{"Count", "[", 
                RowBox[{"propList", ",", " ", "Eik"}], "]"}]}], "}"}]}], 
            "]"}], ";", "  ", "\[IndentingNewLine]", 
           RowBox[{"shiftedIntegrandLeft", " ", "=", " ", 
            RowBox[{"FORMString", "[", 
             RowBox[{"shiftedIntegrandLeft", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", "\"\<r1?\>\""}], "]"}], "2"], "\[Rule]",
                  " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r1?\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4?\>\""}], "]"}]}]}], ",", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", "\"\<r2?\>\""}], "]"}], "2"], "\[Rule]",
                  " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r2?\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4?\>\""}], "]"}]}]}], ",", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", " ", "\"\<r1?\>\""}], "]"}], "3"], " ", 
                 "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r1?\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4?\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r5?\>\""}], "]"}]}]}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"shiftedIntegrandRight", " ", "=", " ", 
            RowBox[{"FORMString", "[", 
             RowBox[{"shiftedIntegrandRight", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", "\"\<r1\>\""}], "]"}], "2"], "\[Rule]", 
                 " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r1\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4\>\""}], "]"}]}]}], ",", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", "\"\<r2\>\""}], "]"}], "2"], "\[Rule]", 
                 " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r2\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4\>\""}], "]"}]}]}], ",", " ", 
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"Eik", "[", 
                   RowBox[{"k_", ",", " ", "\"\<r1\>\""}], "]"}], "3"], " ", 
                 "\[Rule]", " ", 
                 RowBox[{
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r1\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r4\>\""}], "]"}], " ", 
                  RowBox[{"Eik", "[", 
                   RowBox[{"k", ",", "\"\<r5\>\""}], "]"}]}]}]}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"momshifts", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], "===", 
              " ", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"WriteString", "[", 
               RowBox[{
               "file", ",", "\[IndentingNewLine]", "\"\<id \>\"", ",", 
                "shiftedIntegrandLeft", ",", "\"\< = \>\"", ",", 
                "\[IndentingNewLine]", "shiftedIntegrandRight", ",", 
                "\"\<*replace_(\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"FORMString", "[", "k", "]"}], ",", "\"\<,\>\"", ",", 
                
                RowBox[{"FORMString", "[", 
                 RowBox[{
                  RowBox[{"momshifts", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<);\\n\>\""}], "]"}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"WriteString", "[", 
               RowBox[{
               "file", ",", "\[IndentingNewLine]", "\"\<id \>\"", ",", 
                "shiftedIntegrandLeft", ",", "\"\< = \>\"", ",", 
                "\[IndentingNewLine]", "shiftedIntegrandRight", ",", 
                "\"\<*replace_(\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"FORMString", "[", "k", "]"}], ",", "\"\<,\>\"", ",", 
                
                RowBox[{"FORMString", "[", 
                 RowBox[{
                  RowBox[{"2", "k"}], " ", "-", 
                  RowBox[{
                   RowBox[{"momshifts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", "\"\<);\\n\>\""}], "]"}], ";"}]}], 
            "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"momshifts", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
       
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", 
         RowBox[{"Length", "[", "perfectIntegrands", "]"}]}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<\\n\>\""}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8500148835369797`*^9, 3.850014963174385*^9}, {
   3.850015026216017*^9, 3.8500152835576897`*^9}, {3.8500153242978363`*^9, 
   3.850015406615103*^9}, {3.8500157650453157`*^9, 3.850015766370352*^9}, {
   3.850015843710568*^9, 3.85001595346231*^9}, {3.850015989921455*^9, 
   3.8500160339692287`*^9}, {3.8500161704396057`*^9, 
   3.8500161948249617`*^9}, {3.850016226502248*^9, 3.8500162270108757`*^9}, {
   3.8500162778353863`*^9, 3.850016306257195*^9}, {3.850016346520917*^9, 
   3.85001642732898*^9}, {3.850017084239778*^9, 3.850017117704939*^9}, {
   3.8500171507160587`*^9, 3.850017163439554*^9}, {3.850017222724667*^9, 
   3.850017225208192*^9}, 3.850017495379979*^9, {3.850018078104059*^9, 
   3.850018078719055*^9}, {3.850019349340419*^9, 3.8500193808965597`*^9}, {
   3.850022704385693*^9, 3.850022724577029*^9}, {3.85003685194516*^9, 
   3.8500369576211367`*^9}, {3.8500370069225283`*^9, 3.850037044988049*^9}, {
   3.850039507103301*^9, 3.850039540946787*^9}, {3.85003959129766*^9, 
   3.8500396211976*^9}, {3.850039829645604*^9, 3.850039830256961*^9}, {
   3.850040139850748*^9, 3.8500401522075663`*^9}, {3.850052520793962*^9, 
   3.850052520857296*^9}, {3.850052588219864*^9, 3.8500525884842854`*^9}, {
   3.850052672539259*^9, 3.850052687884454*^9}, {3.850054057592238*^9, 
   3.8500540597391853`*^9}, {3.850089226575728*^9, 3.850089253219808*^9}, {
   3.8501098302973633`*^9, 3.850109834392765*^9}, {3.850109897835918*^9, 
   3.850110008432869*^9}, {3.85011034549413*^9, 3.850110349573964*^9}, {
   3.850117849775619*^9, 3.850117872669804*^9}, {3.8505664068532248`*^9, 
   3.850566431822344*^9}, {3.8637595129556828`*^9, 3.8637595412755632`*^9}, {
   3.863759608395409*^9, 3.863759611706012*^9}, {3.8637596942021112`*^9, 
   3.863759778800761*^9}, {3.863759885155944*^9, 3.863759963811672*^9}, {
   3.8637602677907887`*^9, 3.863760270214608*^9}, {3.8637604944209967`*^9, 
   3.863760495559083*^9}, {3.863760731762569*^9, 3.863760757130825*^9}, {
   3.8637608110501757`*^9, 3.863760814092684*^9}, {3.8637609333372602`*^9, 
   3.863760967233411*^9}, {3.863761128091078*^9, 3.8637611299943237`*^9}, {
   3.863766368100031*^9, 3.863766380195552*^9}, {3.864183281193385*^9, 
   3.864183290001725*^9}, 3.864183329015092*^9, {3.864184494830535*^9, 
   3.864184508372506*^9}, {3.864184775147009*^9, 3.864184828300247*^9}, 
   3.864184870834687*^9, {3.864184938640663*^9, 3.864185047865786*^9}, {
   3.8641851159847097`*^9, 3.864185212663137*^9}, {3.864185375717063*^9, 
   3.864185380492259*^9}, {3.864185573421653*^9, 3.864185690493307*^9}, {
   3.8641858304621763`*^9, 3.864185868929517*^9}, {3.864185944514399*^9, 
   3.864186021518708*^9}, {3.8641860763442297`*^9, 3.864186084152318*^9}, {
   3.864186188775158*^9, 3.864186192242978*^9}, {3.864187153917696*^9, 
   3.864187202634894*^9}, {3.8641872468911247`*^9, 3.864187265376273*^9}, {
   3.864187333383388*^9, 3.864187368577959*^9}, {3.864187426908749*^9, 
   3.86418743836961*^9}, 3.864354926617621*^9, {3.8643549696002903`*^9, 
   3.864355052335927*^9}, {3.864355097022643*^9, 3.864355150355926*^9}, {
   3.8643552316957083`*^9, 3.864355281439477*^9}, {3.8643554198085318`*^9, 
   3.86435550339468*^9}, {3.864355542856723*^9, 3.8643556069433823`*^9}, {
   3.864355651735744*^9, 3.864355672576027*^9}, 3.8643558722757483`*^9, {
   3.864355918963504*^9, 3.86435595377717*^9}, {3.8643559892296667`*^9, 
   3.864356038575597*^9}, {3.864356283421874*^9, 3.864356350329853*^9}, {
   3.864356383972177*^9, 3.864356435972978*^9}, {3.8643564900902243`*^9, 
   3.8643564992133703`*^9}, {3.864356536050639*^9, 3.864356551514063*^9}, {
   3.8643565945187674`*^9, 3.8643567102853527`*^9}, {3.864356743464108*^9, 
   3.8643567439872417`*^9}, {3.864356786928791*^9, 3.864356804676511*^9}, {
   3.8643568581493587`*^9, 3.864356895502194*^9}, {3.864357313743352*^9, 
   3.864357325368466*^9}, 3.8643574356565647`*^9, 3.864357466854295*^9, {
   3.864357524807364*^9, 3.864357538778782*^9}, 3.8643576188025217`*^9, {
   3.864357655471888*^9, 3.864357659469438*^9}, {3.864357864787676*^9, 
   3.864357870497197*^9}, {3.864358005877927*^9, 3.8643580110559464`*^9}, {
   3.864358127136799*^9, 3.864358136198633*^9}, {3.8643584183814173`*^9, 
   3.8643584547462378`*^9}, {3.864358495845649*^9, 3.864358530956637*^9}, {
   3.8643585874559517`*^9, 3.8643586244047403`*^9}, {3.864358958392104*^9, 
   3.864359021650703*^9}, {3.864359075153201*^9, 3.864359080561782*^9}, {
   3.864359324395071*^9, 3.864359336844798*^9}, {3.8643593704748077`*^9, 
   3.864359415241604*^9}, {3.864359929496838*^9, 3.8643599370109863`*^9}, {
   3.864364136392016*^9, 3.8643641397479486`*^9}, {3.8643641725086403`*^9, 
   3.864364268130748*^9}, {3.864364301271937*^9, 3.864364309744134*^9}, {
   3.864364716251788*^9, 3.864364737889927*^9}, {3.864364923925303*^9, 
   3.864364951984923*^9}, {3.864365017223216*^9, 3.864365022644155*^9}, {
   3.864365281746402*^9, 3.864365364561627*^9}, {3.864365398887703*^9, 
   3.86436541106886*^9}, {3.8643655296054983`*^9, 3.8643656430859613`*^9}, {
   3.86436571514248*^9, 3.864365806488291*^9}, {3.864365853088649*^9, 
   3.864365862044105*^9}, {3.864365950158834*^9, 3.864365961054295*^9}, {
   3.8643729113739643`*^9, 3.8643729188887253`*^9}, {3.8643743548572206`*^9, 
   3.864374375036274*^9}, 3.864374437748007*^9, {3.864375545592328*^9, 
   3.864375700781088*^9}, {3.864375796186166*^9, 3.864375798618046*^9}, 
   3.864375916291305*^9, {3.8643763489648027`*^9, 3.864376353444405*^9}, {
   3.86437681763444*^9, 3.864376827871306*^9}, {3.864376918560964*^9, 
   3.864376976804185*^9}, 3.864377900024681*^9, {3.8643790345319147`*^9, 
   3.8643790674777107`*^9}, {3.86437920103741*^9, 3.864379206445279*^9}, {
   3.864379245776278*^9, 3.864379260526585*^9}, {3.86437962623769*^9, 
   3.8643796460310783`*^9}, {3.8643811216944923`*^9, 3.864381130501573*^9}, {
   3.864381176651333*^9, 3.864381185561007*^9}, {3.864381977268216*^9, 
   3.864382002092922*^9}, {3.864382071002022*^9, 3.864382099871256*^9}, {
   3.864382799478833*^9, 3.8643828452336197`*^9}, {3.8643828888090487`*^9, 
   3.8643829074596148`*^9}, {3.864394959744492*^9, 3.8643949664105873`*^9}, {
   3.8643950050306168`*^9, 3.864395008857254*^9}, {3.864395179804373*^9, 
   3.864395187495739*^9}, {3.8643952330182123`*^9, 3.864395243752329*^9}, {
   3.864395275353422*^9, 3.864395275764421*^9}, {3.8643957825063*^9, 
   3.8643958508353977`*^9}, {3.864396245889503*^9, 3.86439625698529*^9}, {
   3.864396427218747*^9, 3.864396431575914*^9}, {3.86439655410712*^9, 
   3.864396577781816*^9}, 3.864396911480019*^9, {3.864397036370467*^9, 
   3.864397082992134*^9}, {3.864397234322475*^9, 3.864397268981908*^9}, {
   3.864397303341339*^9, 3.864397318652267*^9}, {3.86444117283038*^9, 
   3.864441209563414*^9}, {3.864441262900196*^9, 3.864441313775926*^9}, {
   3.8644413454715643`*^9, 3.864441449800096*^9}, {3.864441831061408*^9, 
   3.864441835036558*^9}, {3.864442042283695*^9, 3.864442044007308*^9}, 
   3.864442077512782*^9, {3.864442747158717*^9, 3.864442760601328*^9}, {
   3.864444121840917*^9, 3.8644441255786963`*^9}, {3.864444300426653*^9, 
   3.864444328966446*^9}, 3.864444483684429*^9, {3.86444454173171*^9, 
   3.8644445836145983`*^9}, {3.864444645414236*^9, 3.864444658913196*^9}, {
   3.864444754266799*^9, 3.864444768207902*^9}, {3.8644448015955477`*^9, 
   3.8644448148219433`*^9}, {3.864444850939087*^9, 3.864444978491356*^9}, {
   3.8644450179962683`*^9, 3.864445039997052*^9}, {3.864445242563699*^9, 
   3.864445256468856*^9}, {3.864445324280579*^9, 3.86444532698031*^9}, {
   3.864445461090678*^9, 3.864445472173123*^9}, {3.864445527518207*^9, 
   3.864445533715486*^9}, {3.864445587730578*^9, 3.8644455976094*^9}, {
   3.864445659196457*^9, 3.864445727260501*^9}, {3.864445783366108*^9, 
   3.8644457856339197`*^9}, {3.864445859820512*^9, 3.8644458627580748`*^9}, {
   3.864445943965665*^9, 3.8644459445266933`*^9}, {3.864806555824292*^9, 
   3.864806560557581*^9}, {3.864806592359832*^9, 3.864806600623375*^9}, 
   3.864880593296915*^9, {3.864959734624106*^9, 3.8649597410288877`*^9}, {
   3.864959888492675*^9, 3.864959966748164*^9}, {3.864960028267757*^9, 
   3.864960039771348*^9}, {3.86496008048589*^9, 3.8649601148478603`*^9}, {
   3.8649601859665213`*^9, 3.864960209352312*^9}, {3.864960272921246*^9, 
   3.86496030345506*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"e7e987b8-5e48-4a91-8f6e-d9304df70d40"],

Cell[BoxData[
 RowBox[{"writeIntegrandNormalizationCode", "[", 
  RowBox[{
  "\"\<Integrands2liners.prc\>\"", ",", " ", "2", ",", "1", ",", "2"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8643837255280457`*^9, 3.864383773085251*^9}, {
  3.864488324955749*^9, 3.864488326049033*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"85515272-a1ad-4ee7-8772-8ed116b43bd7"],

Cell[BoxData[{
 RowBox[{"writeIntegrandNormalizationCode", "[", 
  RowBox[{
  "\"\<Integrands3liners.prc\>\"", ",", " ", "3", ",", "1", ",", "3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"writeIntegrandNormalizationCode", "[", 
  RowBox[{
  "\"\<Integrands4liners.prc\>\"", ",", " ", "4", ",", " ", "1", ",", "3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"writeIntegrandNormalizationCode", "[", 
  RowBox[{
  "\"\<Integrands5liners.prc\>\"", ",", " ", "5", ",", " ", "2", ",", "3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"writeIntegrandNormalizationCode", "[", 
  RowBox[{
  "\"\<Integrands6liners.prc\>\"", ",", " ", "6", ",", " ", "3", ",", "3"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864383804741404*^9, 3.8643839099762983`*^9}, {
   3.864397572734837*^9, 3.864397598241228*^9}, {3.86444235886235*^9, 
   3.864442359476811*^9}, {3.864442504904277*^9, 3.864442524123412*^9}, 
   3.864442689170987*^9, {3.864445921278165*^9, 3.86444592223026*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"b02601c7-4548-4fb4-acae-4d33d14a0b1e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Numerator cancellation code: form/Numerators{2,3,4}liners.prc\
\>", "Section",
 CellChangeTimes->{{3.851945586162992*^9, 3.851945591378868*^9}, {
   3.8519457404541483`*^9, 3.851945762448018*^9}, 3.851945876061063*^9, {
   3.852259752240758*^9, 
   3.85225975632222*^9}},ExpressionUUID->"63beb8e4-a9fe-4f37-95d3-\
612c238d1f55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeNumeratorCancellationCode", "[", 
   RowBox[{
   "filename_", ",", "momenta_List", ",", "multiplicity_Integer", ",", 
    "externalMomenta_List", ",", "loopMomentum_Symbol", ",", 
    RowBox[{"scalarProducts_List", ":", 
     RowBox[{"{", "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"file", ",", "externalMomentumConfigurations", ",", "i"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"externalMomentumConfigurations", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Plus", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"KSetPartitions", "[", 
             RowBox[{"#", ",", 
              RowBox[{"multiplicity", "-", "1"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Subsets", "[", 
            RowBox[{"externalMomenta", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"multiplicity", "-", "1"}], ",", 
               RowBox[{"Length", "[", "externalMomenta", "]"}]}], "}"}]}], 
            "]"}]}], ",", 
          RowBox[{"{", "3", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"externalMomentumConfigurations", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{
            RowBox[{"Permutations", "[", "#", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "==", 
               RowBox[{"Reverse", "[", "#2", "]"}]}], ")"}], "&"}]}], "]"}], 
          "&"}], "/@", "externalMomentumConfigurations"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"file", "=", 
      RowBox[{"OpenWrite", "[", 
       RowBox[{"\"\<form/\>\"", "<>", "filename"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#procedure \>\"", ",", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"filename", ",", 
         RowBox[{"\"\<.prc\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", 
       RowBox[{"\"\<* Generated by \>\"", "<>", 
        RowBox[{"FileNameTake", "[", 
         RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
        "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<b DS,k;\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<.sort\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<Keep Brackets;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#do i=1,1\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "file", ",", "\"\<if (count(DS,1) == \>\"", ",", "multiplicity", ",", 
       "\"\<);\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"writeNumeratorCancellationCode", "[", 
        RowBox[{"file", ",", "momenta", ",", 
         RowBox[{"externalMomentumConfigurations", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "loopMomentum", ",", 
         "scalarProducts"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "externalMomentumConfigurations", "]"}]}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<endif;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "file", ",", "\"\<if (occurs(numtag)) redefine i \\\"0\\\";\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<id numtag = 1;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<b DS,k;\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<.sort\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<Keep Brackets;\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#enddo\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<.sort\\n\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#call Kinematics\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#call NormalizePropagators\\n\\n\>\""}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<#endprocedure\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "file", "]"}], ";"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850039841202075*^9, 3.8500399101069803`*^9}, {
   3.8500399969294357`*^9, 3.8500401203673277`*^9}, {3.850040971404728*^9, 
   3.850041044404405*^9}, {3.850041278337599*^9, 3.850041278405116*^9}, {
   3.850041411610629*^9, 3.8500414610548487`*^9}, {3.85004149257187*^9, 
   3.8500415054460993`*^9}, {3.8500527283117647`*^9, 
   3.8500527445459757`*^9}, {3.850054124128252*^9, 3.850054188800462*^9}, {
   3.850054346903816*^9, 3.8500543566688013`*^9}, {3.8500544990656*^9, 
   3.850054500956541*^9}, {3.850054535294733*^9, 3.8500545358930063`*^9}, {
   3.850110306380042*^9, 3.850110311051998*^9}, {3.850110355916944*^9, 
   3.8501103903026943`*^9}, {3.850110423776518*^9, 3.8501104245140676`*^9}, 
   3.850116319681211*^9, {3.8501182589035387`*^9, 3.850118457040121*^9}, {
   3.8501185104186163`*^9, 3.850118549487513*^9}, {3.850118593459326*^9, 
   3.8501185936217546`*^9}, {3.850118635114984*^9, 3.850118635176631*^9}, {
   3.8501187346602077`*^9, 3.850118751409053*^9}, {3.850446822108975*^9, 
   3.850446849255838*^9}, {3.8504866112201433`*^9, 3.8504866197513847`*^9}, {
   3.850486721865868*^9, 3.85048672245562*^9}, {3.850486939000764*^9, 
   3.850487024411571*^9}, 3.8504870754101257`*^9, {3.8504871209407797`*^9, 
   3.8504871249587173`*^9}, {3.850531071689496*^9, 3.850531104505577*^9}, {
   3.850560526316935*^9, 3.8505605357332973`*^9}, 3.8505606520018063`*^9, {
   3.850560745874712*^9, 3.850560772634039*^9}, {3.850560833077096*^9, 
   3.850560833942819*^9}, 3.850566334781313*^9, 3.8505664389501543`*^9, {
   3.8505664693160763`*^9, 3.850566472565613*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"68db3d0c-cf7b-4e31-98c7-805e1e0e224a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"writeNumeratorCancellationCode", "[", 
   RowBox[{
   "file_", ",", "momenta_List", ",", "externalMomenta_List", ",", 
    "loopMomentum_Symbol", ",", "scalarProducts_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "integrand", ",", "internalMomenta", ",", "equations", ",", "solution", 
      ",", 
      RowBox[{"products", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"loopMomentum", "#"}], "\[Rule]", " ", 
          RowBox[{"loopMomentum", ".", "#"}]}], "&"}], "/@", "momenta"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"internalMomenta", "=", 
      RowBox[{"loopMomentum", "+", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Plus", "@@", 
          RowBox[{"externalMomenta", "[", 
           RowBox[{"[", 
            RowBox[{";;", "i"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "externalMomenta", "]"}]}], "}"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "internalMomenta", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "externalMomenta", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"equations", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"0", "==", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"DS", "[", "#", "]"}]}], "-", 
             RowBox[{"Expand", "[", 
              RowBox[{"#", "^", "2"}], "]"}]}]}], "/.", "scalarProducts"}], "/.",
           "products"}], ")"}], "&"}], "/@", "internalMomenta"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solution", "=", 
      RowBox[{
       RowBox[{"ExpandAll", "[", 
        RowBox[{"Solve", "[", 
         RowBox[{"equations", ",", 
          RowBox[{"Last", "/@", "products"}]}], "]"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"loopMomentum", "^", "2"}], "\[Rule]", 
        RowBox[{"1", "/", 
         RowBox[{"DS", "[", "loopMomentum", "]"}]}]}]}]}], ";", 
     RowBox[{"integrand", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"(", 
        RowBox[{"DS", "/@", 
         RowBox[{"Prepend", "[", 
          RowBox[{"internalMomenta", ",", "loopMomentum"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"solution", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}], "integrand"}], 
        ",", 
        RowBox[{"DS", "[", "__", "]"}]}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{"file", ",", "\"\<id \>\"", ",", 
         RowBox[{"FORMString", "[", 
          RowBox[{
           RowBox[{"solution", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i", ",", "1"}], "]"}], "]"}], "integrand"}], 
          "]"}], ",", "\"\< = \>\"", ",", 
         RowBox[{"FORMString", "[", 
          RowBox[{"numtag", " ", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"solution", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}], 
              "integrand"}], ",", 
             RowBox[{"DS", "[", "__", "]"}]}], "]"}]}], "]"}], ",", 
         "\"\<;\\n\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"solution", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{"file", ",", "\"\<\\n\>\""}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.850020996588771*^9, 3.8500210285722837`*^9}, {
   3.850021075486163*^9, 3.850021147527136*^9}, {3.850021199005031*^9, 
   3.8500212595961113`*^9}, {3.8500212914134007`*^9, 
   3.8500213907211533`*^9}, {3.8500214247536287`*^9, 3.850021564344645*^9}, {
   3.850021645744666*^9, 3.850021688527667*^9}, {3.8500217436291447`*^9, 
   3.850021786948188*^9}, {3.8500218240953093`*^9, 3.850021828438901*^9}, {
   3.850021878348823*^9, 3.850021954617936*^9}, {3.850022145654808*^9, 
   3.8500222762157907`*^9}, {3.850022318843672*^9, 3.850022318982232*^9}, {
   3.850022380803491*^9, 3.85002240262852*^9}, {3.850022439903532*^9, 
   3.8500225758772573`*^9}, {3.850022617675462*^9, 3.850022631123695*^9}, {
   3.8500227389240513`*^9, 3.850022742730013*^9}, {3.850023167940473*^9, 
   3.850023169492687*^9}, {3.850023256949484*^9, 3.850023296254253*^9}, {
   3.850023348165277*^9, 3.850023378271906*^9}, {3.850023458382079*^9, 
   3.850023470518591*^9}, {3.850023507799891*^9, 3.850023549090122*^9}, {
   3.85002360427943*^9, 3.8500236070797453`*^9}, {3.8500357111646*^9, 
   3.85003573828902*^9}, 3.850035804149954*^9, {3.850035910204463*^9, 
   3.850035918508773*^9}, 3.850035962025341*^9, {3.8500402488003483`*^9, 
   3.8500402605918818`*^9}, {3.850040294683147*^9, 3.850040296459399*^9}, 
   3.850041094394126*^9, {3.85004113320546*^9, 3.850041134720337*^9}, {
   3.8500412847828007`*^9, 3.850041284842201*^9}, {3.850041420396393*^9, 
   3.8500414209283123`*^9}, {3.850041521798905*^9, 3.850041545357244*^9}, {
   3.850052732542281*^9, 3.850052739516265*^9}, 3.850052775922576*^9, 
   3.8500541920888453`*^9, {3.850054531731287*^9, 3.850054532568722*^9}, {
   3.850110326019353*^9, 3.8501103263958178`*^9}, {3.850110395491764*^9, 
   3.850110421779148*^9}, {3.850118201147736*^9, 3.850118202990086*^9}, {
   3.8501185678476048`*^9, 3.850118588097475*^9}, {3.864448953873913*^9, 
   3.864448957590135*^9}, {3.864448990107092*^9, 3.864448990339449*^9}, {
   3.864449078271974*^9, 3.864449081407852*^9}, {3.864449130805904*^9, 
   3.8644491439619913`*^9}, {3.86444924581415*^9, 3.864449278719983*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"68ab178b-1a0a-41b8-938e-cea59f957887"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"writeNumeratorCancellationCode", "[", 
     RowBox[{
      RowBox[{"\"\<Numerators\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<liners.prc\>\""}], ",",
       "momenta", ",", "i", ",", "momenta", ",", "k", ",", "scalars"}], "]"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3", ",", "3"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.85194558044387*^9, {3.852259351146343*^9, 3.8522594243627043`*^9}, {
   3.852259778567361*^9, 3.85225978185009*^9}, {3.864447976935083*^9, 
   3.864447977649364*^9}, {3.864448966249733*^9, 3.8644489979135523`*^9}, {
   3.864449075101902*^9, 3.864449075697628*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"888d3153-5aba-4348-bb37-9ece67ecd8f1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k", "+", "p3"}], ",", 
   RowBox[{"k", "+", "p3", "+", "p4"}]}], "}"}]], "Print",
 CellChangeTimes->{{3.864448969099709*^9, 3.864448979841076*^9}, 
   3.864449086463931*^9, {3.864449135310732*^9, 3.86444914864886*^9}, {
   3.864449259091927*^9, 3.864449282694058*^9}},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"c8a4e8df-3221-4c16-b662-315590fb277e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"p3", ",", "p4"}], "}"}]], "Print",
 CellChangeTimes->{{3.864448969099709*^9, 3.864448979841076*^9}, 
   3.864449086463931*^9, {3.864449135310732*^9, 3.86444914864886*^9}, {
   3.864449259091927*^9, 3.864449282698216*^9}},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"29ef9edb-daf8-4324-8a27-5866f5a1dcab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"DS", "[", "k", "]"}], " ", 
   RowBox[{"DS", "[", 
    RowBox[{"k", "+", "p3", "+", "p4"}], "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"DS", "[", 
    RowBox[{"k", "+", "p3"}], "]"}], " ", 
   RowBox[{"DS", "[", 
    RowBox[{"k", "+", "p3", "+", "p4"}], "]"}]}]}]], "Print",
 CellChangeTimes->{{3.864448969099709*^9, 3.864448979841076*^9}, 
   3.864449086463931*^9, {3.864449135310732*^9, 3.86444914864886*^9}, {
   3.864449259091927*^9, 3.8644492827017612`*^9}},
 CellLabel->
  "During evaluation of \
In[85]:=",ExpressionUUID->"fccf2585-e8b4-4ab5-9134-9d828eac8838"]
}, Open  ]]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.864449273089468*^9},ExpressionUUID->"cb047328-fe89-4f0d-b966-\
1216bd069229"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Passarino-Veltman reduction code: form/PVreduction{2,3,4}liners.h and \
form/PVreductionTests.h\
\>", "Section",
 CellChangeTimes->{{3.850053104480906*^9, 3.850053110641062*^9}, {
   3.851945610290297*^9, 3.851945617962009*^9}, {3.851945778563492*^9, 
   3.851945815176836*^9}, 3.851945879843471*^9, {3.852279636741907*^9, 
   3.8522796620839453`*^9}, {3.8524328532373037`*^9, 
   3.852432853920692*^9}},ExpressionUUID->"a810eb9d-2b1c-4136-b5ef-\
be189b974b84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ktensors", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<K(a1?)\>\"", ",", "\"\<K(a1?,a2?)\>\"", ",", 
     "\"\<K(a1?,a2?,a3?)\>\"", ",", "\"\<K(a1?,a2?,a3?,a4?)\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.851945840198718*^9},
 CellLabel->"In[8]:=",ExpressionUUID->"e2efb87d-3c62-4629-8449-9031a3c018a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"tensor", "[", 
      RowBox[{"3", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "p34"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p34"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "n", ",", " ", "p2", ",", " ", "p34"}], "]"}], 
     ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "n", ",", " ", "p3", ",", " ", "p4"}], "]"}], 
     ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p1", ",", "p3"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p1", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p2", ",", "p3"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p2", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "n", ",", " ", "p1", ",", " ", "p34"}], "]"}], 
     ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "p3"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "p3", ",", " ", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", " ", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p1", ",", "p2", ",", "p4"}], "]"}], ",", 
     " ", 
     RowBox[{"tensor", "[", 
      RowBox[{
      "2", ",", " ", "n", ",", " ", "p1", ",", " ", "p2", ",", " ", "p34"}], 
      "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p1", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}], ",", 
     " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"2", ",", "n", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p2", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p2", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p2", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p2", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p2"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p2", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p3"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p2", ",", "p3"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p2", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p2", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p2"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p34"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p2", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p2", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p2", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p3", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p2", ",", "p3", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p1", ",", "p2", ",", "p34"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p3", ",", "p4"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p2", ",", "p3"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p4"}], "]"}], ",", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "p34"}], "]"}], ",", " ", 
     RowBox[{"tensor", "[", 
      RowBox[{"1", ",", "n", ",", "p1", ",", "p2", ",", "p3", ",", "p4"}], 
      "]"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdylkowwEAx/F/czww5D4aknigNEuOIVuOnOXILCtsjsSWZuQvG1mLcjXz
5FoeJ8VyNDme5IiMhDRHTZLjv5qjyBH/3x5+ffrVN0LSUlrPIAgijB4MWFFZ
BEaKf8dov4Sv3fH909sU/7PaOAALD6U/1n36/zX/QrOW43FLO8IeD4ZDVEso
ZIdUxMAHZXgKFLrNpUFul54HZ6LSa6E9f3DpmfaqV26CQ7daMUWr7lFI4ElJ
bazzAcV/W/t2+JShzoYrX9wceGMtaIR6Q0MT1LiLSNjUWdkJX7StfdD3jNcP
n6cuRqG355zO0ScdTUBO+PoktLFkBni1oJuFpwnJJrjmJ1qFxZMyCyQjhy9h
WpvoDi6Khfcw0Vxuh8bc4HfIHn4kXGizorecYFDgsSeM6yjwgnLFLheSyy+p
jk52o4PSDc0Y3LHbmK60e9cqD1jnv1kNXVlFNVCdV59SRTufSXDh+XapAO5/
CB36fDCVkAwqU8F/X339yw==
  "],
 CellLabel->"In[15]:=",ExpressionUUID->"16f21213-0346-4c54-bf46-e28bb4ac3c46"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PVreduction", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"tensors", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"tensors", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"tensor", "[", 
          RowBox[{"rank_", ",", "vectors__"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"ReduceTensor", "[", 
          RowBox[{"k", ",", 
           RowBox[{"{", "vectors", "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4", ",", "a5"}], 
             "}"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", "rank"}], "]"}], "]"}], ",", "scalars"}], 
          "]"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "tensors", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8502033478793373`*^9, 3.850203355626039*^9}, {
   3.8502033992559443`*^9, 3.8502034953501387`*^9}, {3.850203529720879*^9, 
   3.850203529812895*^9}, {3.850203637877287*^9, 3.850203645660488*^9}, {
   3.850203711811269*^9, 3.850203711944642*^9}, {3.850203814732072*^9, 
   3.850203816661113*^9}, {3.850204083070776*^9, 3.85020408377853*^9}, {
   3.8502043484146757`*^9, 3.8502043585342407`*^9}, {3.8502044291550293`*^9, 
   3.850204454822094*^9}, {3.850204992453163*^9, 3.850205014684379*^9}, {
   3.8502050489065447`*^9, 3.850205058986477*^9}, {3.850205289336938*^9, 
   3.850205294781267*^9}, {3.85020533378444*^9, 3.850205333894643*^9}, {
   3.8502053795141983`*^9, 3.850205403293331*^9}, {3.850205446025503*^9, 
   3.850205530108636*^9}, {3.850274851919634*^9, 3.8502748542619247`*^9}, {
   3.8503015502234097`*^9, 3.850301567633917*^9}, {3.8503016015210257`*^9, 
   3.8503016029175053`*^9}, 3.850301670576654*^9, {3.850302748060746*^9, 
   3.8503027504364347`*^9}, {3.850303228659008*^9, 3.8503032298794527`*^9}, {
   3.850306668900631*^9, 3.8503066696436987`*^9}, {3.850306927123761*^9, 
   3.850306957665547*^9}, {3.850306987800795*^9, 3.8503069885514307`*^9}, {
   3.850307263993294*^9, 3.850307264769038*^9}, {3.850388456363882*^9, 
   3.850388502055838*^9}, {3.850388550721446*^9, 3.85038856808531*^9}, {
   3.8503909989335318`*^9, 3.850391012998867*^9}, {3.850558827231793*^9, 
   3.850558827949985*^9}, 3.8519456388838463`*^9, 3.852432793602429*^9, {
   3.864486631072811*^9, 3.864486642614953*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"751eeeec-7a65-4e95-a529-ea6f0983d144"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Passarino-Veltman reduction impossible 1\"\>"], "Print",
 CellChangeTimes->{3.8644866857722273`*^9, 3.8645354368655033`*^9, 
  3.86453561402827*^9, 3.864535897995236*^9, 3.864536020010687*^9, 
  3.864536127701066*^9, 3.864536218404736*^9, 3.8645362965925903`*^9, 
  3.8645364031914167`*^9, 3.8645365377973948`*^9, 3.864536813867221*^9, 
  3.864536892089375*^9, 3.864536999345352*^9, 3.8645371238836517`*^9, 
  3.864537224963705*^9, 3.86453757688*^9, 3.864538275856532*^9, 
  3.864539260917429*^9, 3.864539924406809*^9, 3.864719879551635*^9, 
  3.864720057567418*^9, 3.864720376091782*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"3f9979c5-91cf-4b21-94c9-9f16d5b320e4"],

Cell[BoxData["\<\"Passarino-Veltman reduction impossible 1\"\>"], "Print",
 CellChangeTimes->{3.8644866857722273`*^9, 3.8645354368655033`*^9, 
  3.86453561402827*^9, 3.864535897995236*^9, 3.864536020010687*^9, 
  3.864536127701066*^9, 3.864536218404736*^9, 3.8645362965925903`*^9, 
  3.8645364031914167`*^9, 3.8645365377973948`*^9, 3.864536813867221*^9, 
  3.864536892089375*^9, 3.864536999345352*^9, 3.8645371238836517`*^9, 
  3.864537224963705*^9, 3.86453757688*^9, 3.864538275856532*^9, 
  3.864539260917429*^9, 3.864539924406809*^9, 3.864719879551635*^9, 
  3.864720057567418*^9, 3.864720376353526*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"875fb775-46a9-4058-b7ba-a873f0f45aed"],

Cell[BoxData["\<\"Passarino-Veltman reduction impossible 1\"\>"], "Print",
 CellChangeTimes->{3.8644866857722273`*^9, 3.8645354368655033`*^9, 
  3.86453561402827*^9, 3.864535897995236*^9, 3.864536020010687*^9, 
  3.864536127701066*^9, 3.864536218404736*^9, 3.8645362965925903`*^9, 
  3.8645364031914167`*^9, 3.8645365377973948`*^9, 3.864536813867221*^9, 
  3.864536892089375*^9, 3.864536999345352*^9, 3.8645371238836517`*^9, 
  3.864537224963705*^9, 3.86453757688*^9, 3.864538275856532*^9, 
  3.864539260917429*^9, 3.864539924406809*^9, 3.864719879551635*^9, 
  3.864720057567418*^9, 3.864720383234151*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"1809f279-ee39-4de2-bf19-ed5326951878"],

Cell[BoxData["\<\"Passarino-Veltman reduction impossible 1\"\>"], "Print",
 CellChangeTimes->{3.8644866857722273`*^9, 3.8645354368655033`*^9, 
  3.86453561402827*^9, 3.864535897995236*^9, 3.864536020010687*^9, 
  3.864536127701066*^9, 3.864536218404736*^9, 3.8645362965925903`*^9, 
  3.8645364031914167`*^9, 3.8645365377973948`*^9, 3.864536813867221*^9, 
  3.864536892089375*^9, 3.864536999345352*^9, 3.8645371238836517`*^9, 
  3.864537224963705*^9, 3.86453757688*^9, 3.864538275856532*^9, 
  3.864539260917429*^9, 3.864539924406809*^9, 3.864719879551635*^9, 
  3.864720057567418*^9, 3.864720383585382*^9},
 CellLabel->
  "During evaluation of \
In[16]:=",ExpressionUUID->"28f99c81-6efc-4891-a9b4-4ee68b582dbd"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"file", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"\"\<form/PVreduction\>\"", "<>", 
       RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<liners.h\>\""}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", 
      RowBox[{"\"\<* Generated by \>\"", "<>", 
       RowBox[{"FileNameTake", "[", 
        RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
       "\"\<\\n\\n\>\""}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"PVreduction", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], "=!=", "n"}],
              "&&", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"PVreduction", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "\[Equal]", 
              "i"}]}], ")"}], "||", "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"PVreduction", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1", ",", "2"}], "]"}], "]"}], "===", "n"}],
              "&&", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"PVreduction", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"i", "+", "1"}]}]}], ")"}]}], ")"}], "&&", 
         RowBox[{
          RowBox[{"PVreduction", "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "2"}], "]"}], "]"}], "=!=", "Null"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"WriteString", "[", 
         RowBox[{"file", ",", "\"\<id \>\"", ",", 
          RowBox[{"FORMString", "[", 
           RowBox[{"PVreduction", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], ",", "\"\<*\>\"", 
          ",", 
          RowBox[{"ktensors", "[", 
           RowBox[{"[", 
            RowBox[{"PVreduction", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], 
          ",", "\"\< = \>\"", ",", 
          RowBox[{"FORMString", "[", 
           RowBox[{"PVreduction", "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}], ",", 
          "\"\<;\\n\\n\>\""}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "PVreduction", "]"}]}], "}"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "file", "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2", ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.850393269382056*^9, 3.850393404559883*^9}, {
   3.850393464179785*^9, 3.8503934970222063`*^9}, {3.85039352742177*^9, 
   3.850393672534093*^9}, {3.850394053765148*^9, 3.850394054964357*^9}, {
   3.850455497552764*^9, 3.850455520729568*^9}, {3.8504555978587027`*^9, 
   3.850455605396665*^9}, {3.85045567207644*^9, 3.850455715218753*^9}, {
   3.8504557556542683`*^9, 3.8504558140416307`*^9}, {3.85045585177841*^9, 
   3.850455891106634*^9}, {3.85048819282952*^9, 3.850488192942628*^9}, 
   3.85055970521253*^9, 3.850560006907716*^9, {3.850561003477738*^9, 
   3.850561003862933*^9}, {3.850566541108056*^9, 3.85056654281472*^9}, 
   3.8519458371806507`*^9, {3.852259432358292*^9, 3.852259438269034*^9}, {
   3.852259996056512*^9, 3.8522599976773567`*^9}, {3.852432804829136*^9, 
   3.852432812207259*^9}, {3.861703747965418*^9, 3.861703768069831*^9}, {
   3.864486625725953*^9, 3.864486626157054*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"4593ffe4-c589-4a8b-bbcc-d565f0fcb40e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PVreductionTests", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"tensors", "/.", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"rank_", ",", "vectors__"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ORIGINAL", "-", 
         RowBox[{"REDUCED", " ", 
          RowBox[{"tensor", "[", 
           RowBox[{"rank", ",", "vectors"}], "]"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"K", "@@", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "rank"}], "]"}], "]"}]}], ")"}], 
       RowBox[{"SymmetricTensors", "[", 
        RowBox[{
         RowBox[{"{", "vectors", "}"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "}"}], "[", 
          RowBox[{"[", 
           RowBox[{";;", "rank"}], "]"}], "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.8519458549730797`*^9, 3.852432844781966*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"f3f74ee0-9231-4143-a3e9-4d8b53bb17ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/PVPVreductionTests.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", "\"\<g test\>\"", ",", "i", ",", "\"\< = \>\"", ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"PVreductionTests", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\\n\\n\>\""}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "PVreductionTests", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#define ntests \\\"\>\"", ",", 
    RowBox[{"Length", "[", "PVreductionTests", "]"}], ",", 
    "\"\<\\\"\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.850721508755321*^9, 3.850721575217986*^9}, {
   3.850721775000186*^9, 3.8507218076322412`*^9}, {3.850722068413556*^9, 
   3.8507220685087137`*^9}, {3.850722117361236*^9, 3.850722117450169*^9}, 
   3.850722208731588*^9, {3.850722282913767*^9, 3.850722287097657*^9}, {
   3.850722405215012*^9, 3.850722435287071*^9}, {3.850722493368341*^9, 
   3.850722671050264*^9}, {3.850722859959255*^9, 3.850722893115265*^9}, {
   3.8507231531434593`*^9, 3.85072315363142*^9}, {3.850830427515037*^9, 
   3.850830434740308*^9}, 3.850830515433384*^9, {3.850830789653557*^9, 
   3.850830790093704*^9}, 3.851945851896268*^9, {3.852259620166256*^9, 
   3.8522596203580933`*^9}, {3.852279817004511*^9, 3.852279821476297*^9}, {
   3.852432846241335*^9, 3.852432848674283*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"d78ef719-2ccd-42b3-8479-de7d1f3380d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["IBP reduction code: form/IBPreduction.h", "Section",
 CellChangeTimes->{{3.8514807496283092`*^9, 3.8514807718938427`*^9}, {
  3.8517758366235247`*^9, 3.8517758370759573`*^9}, {3.851945676390731*^9, 
  3.8519456786749487`*^9}, {3.851945885240116*^9, 
  3.8519458859655333`*^9}},ExpressionUUID->"181067b8-b76e-4d37-8cc7-\
e5918c4172a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hardmomenta", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.864880852393878*^9, 3.864880860221133*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"86de1129-d184-4eac-a91b-d5b734b9d961"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IBPkira", "=", 
   RowBox[{
   "Get", "[", "\"\<IBPreduction/results/Eikonal/kira_31_0_0.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.851316574642198*^9, 3.851316577605742*^9}, {
  3.851835612770403*^9, 3.851835620885603*^9}, {3.851835852833789*^9, 
  3.8518358539612913`*^9}, {3.851947320697373*^9, 3.851947327080418*^9}, {
  3.85220015662127*^9, 3.852200166537899*^9}, {3.852259604813147*^9, 
  3.852259605019781*^9}, {3.864877754890785*^9, 3.86487775623722*^9}, {
  3.864877791902669*^9, 3.8648777929595413`*^9}, {3.864878662738126*^9, 
  3.864878663670444*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"baf84354-a487-42ec-a2b7-b8b6c7b35f64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InsertEikonalIntegrands", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{
    RowBox[{"Eikonal", "[", "args__", "]"}], ":>", 
    RowBox[{
    "EikonalIntegrand", "[", "args", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EikonalIntegrand", "[", 
   RowBox[{
   "n1_", ",", "n2_", ",", "n3_", ",", "n4_", ",", "n5_", ",", "d___"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "integrand", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"integrand", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Thread", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"DS", "[", "k", "]"}], ",", 
            RowBox[{"DS", "[", 
             RowBox[{"k", "+", "p3"}], "]"}], ",", 
            RowBox[{"DS", "[", 
             RowBox[{"k", "+", "p3", "+", "p4"}], "]"}], ",", 
            RowBox[{"Eik", "[", 
             RowBox[{"k", ",", " ", "p1"}], "]"}], ",", " ", 
            RowBox[{"Eik", "[", 
             RowBox[{
              RowBox[{"k", "+", "p3", "+", "p4"}], ",", "p2"}], "]"}]}], 
           "}"}], "^", 
          RowBox[{"{", 
           RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5"}], 
           "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     RowBox[{"integrand", "=", 
      RowBox[{"integrand", "/.", 
       RowBox[{"k", "\[Rule]", 
        RowBox[{
         RowBox[{"2", "k"}], "-", 
         RowBox[{"integrand", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Int", "[", 
      RowBox[{
       RowBox[{"Times", "@@", "integrand"}], ",", "d"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8513123095713873`*^9, 3.8513124087787523`*^9}, {
   3.85131245188476*^9, 3.851312532171534*^9}, {3.851312562941066*^9, 
   3.851312719448997*^9}, {3.85131283578402*^9, 3.8513129305421762`*^9}, {
   3.851313090886662*^9, 3.8513130993228188`*^9}, {3.8513138449907913`*^9, 
   3.851313861761751*^9}, {3.851315491022973*^9, 3.851315491231061*^9}, {
   3.851315812127153*^9, 3.851315863477343*^9}, {3.851315967572809*^9, 
   3.851315968184697*^9}, {3.851316083634487*^9, 3.8513162409967327`*^9}, {
   3.851316302201887*^9, 3.85131634600521*^9}, {3.851343807725362*^9, 
   3.851343836921657*^9}, {3.851343876696225*^9, 3.8513438785724297`*^9}, {
   3.851344337487486*^9, 3.851344409128943*^9}, {3.8513444562257423`*^9, 
   3.851344514549697*^9}, {3.8513445636425533`*^9, 3.851344568286849*^9}, 
   3.851347062909185*^9, {3.8513475101338263`*^9, 3.8513475125245733`*^9}, {
   3.851348713666575*^9, 3.851348715372075*^9}, {3.851482149384878*^9, 
   3.851482154555174*^9}, {3.851948047178989*^9, 3.851948047180719*^9}, {
   3.852001696544053*^9, 3.852001771066293*^9}, {3.852001806487941*^9, 
   3.852001861061956*^9}, {3.852001924054936*^9, 3.852001947249774*^9}, {
   3.852001986196445*^9, 3.852002000854858*^9}, 3.8520026818427143`*^9, {
   3.852002814948019*^9, 3.85200284744296*^9}, {3.852002942799172*^9, 
   3.852002956168597*^9}, {3.852206157858346*^9, 3.852206237135892*^9}, {
   3.8648781763821783`*^9, 3.864878214889522*^9}, {3.864878399133806*^9, 
   3.864878400544403*^9}, {3.8648786877420053`*^9, 3.864878692489956*^9}, {
   3.864879462664131*^9, 3.864879485041857*^9}, {3.864879598505869*^9, 
   3.864879602534609*^9}, {3.8648797305195293`*^9, 3.864879739474037*^9}, {
   3.864879935844864*^9, 3.864879941881386*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"a857560c-912b-4347-a6dd-f2e2c7a81112"],

Cell[BoxData[
 RowBox[{
  RowBox[{"format", "[", "expr_", "]"}], ":=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Collect", "[", 
          RowBox[{"expr", ",", 
           RowBox[{"Int", "[", "__", "]"}], ",", 
           RowBox[{
            RowBox[{"Apart", "[", 
             RowBox[{"#", ",", "d"}], "]"}], "&"}]}], "]"}], "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{"a_Integer", "+", 
              RowBox[{"b_.", " ", "d"}]}], ")"}]}], ")"}], "->", 
          RowBox[{"den", "[", 
           RowBox[{"a", "+", 
            RowBox[{"b", " ", "d"}]}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Int", "[", "__", "]"}], ",", 
          RowBox[{"den", "[", "_", "]"}]}], "}"}], ",", "FullSimplify"}], 
       "]"}], "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"x_", "+", "y_"}], ")"}]}], ")"}], "\[Rule]", 
       RowBox[{"den", "[", 
        RowBox[{"x", "+", "y"}], "]"}]}]}], "/.", "scalars"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Int", "[", "__", "]"}], ",", 
      RowBox[{"den", "[", "_", "]"}]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.852200614513938*^9, 3.85221176701621*^9, {3.852211850681159*^9, 
   3.8522118723517427`*^9}, {3.852211946063583*^9, 3.852212044654499*^9}, {
   3.8522120868877087`*^9, 3.852212106354486*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"5b4c7558-8c15-4db1-8b54-23feb6128f84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IBPreduction", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"IBPkira", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], "=!=", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IBPreduction", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"InsertEikonalIntegrands", "[", "IBPreduction", "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=!=", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IBPreduction", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"format", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
      "IBPreduction"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s12", "->", 
       RowBox[{"2", 
        RowBox[{"S", "[", 
         RowBox[{"p1", ",", "p2"}], "]"}]}]}], ",", 
      RowBox[{"s13", "->", 
       RowBox[{"2", 
        RowBox[{"S", "[", 
         RowBox[{"p1", ",", "p3"}], "]"}]}]}], ",", " ", 
      RowBox[{"s14", " ", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        RowBox[{"S", "[", 
         RowBox[{"p1", ",", "p4"}], "]"}]}]}], ",", " ", 
      RowBox[{"s23", " ", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        RowBox[{"S", "[", 
         RowBox[{"p2", ",", " ", "p3"}], "]"}]}]}], ",", " ", 
      RowBox[{"s24", " ", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        RowBox[{"S", "[", 
         RowBox[{"p2", ",", "p4"}], "]"}]}]}], ",", " ", 
      RowBox[{"s34", " ", "\[Rule]", " ", 
       RowBox[{"2", " ", 
        RowBox[{"S", "[", 
         RowBox[{"p3", ",", "p4"}], "]"}]}]}], ",", 
      RowBox[{"p1n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p1", ",", "n"}], "]"}]}], ",", 
      RowBox[{"p2n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p2", ",", "n"}], "]"}]}], ",", 
      RowBox[{"p3n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p3", ",", "n"}], "]"}]}]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8522011094801826`*^9, 3.852201210690434*^9}, {
   3.852201345941098*^9, 3.852201366865786*^9}, 3.852201434870386*^9, {
   3.852432726393284*^9, 3.852432752038004*^9}, {3.861703769619526*^9, 
   3.8617037726882677`*^9}, 3.864879486243264*^9, {3.864881920420339*^9, 
   3.864881996975349*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"3a43d2a1-105d-4e6d-88b0-1c862f1c3bb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"permutations1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"momenta", "\[Rule]", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Permutations", "[", "momenta", "]"}]}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permutations2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{"hardmomenta", "\[Rule]", " ", "#"}], "]"}], "&"}], " ", "/@", 
    RowBox[{"Permutations", "[", "hardmomenta", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"permutations", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"AppendTo", "[", 
       RowBox[{"permutations", ",", " ", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{"permutations1", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"permutations2", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "permutations1", "]"}]}], "}"}]}], "]"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", 
      RowBox[{"Length", "[", "permutations2", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IBPreduction", "=", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"IBPreduction", "/.", 
         RowBox[{"permutations", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "permutations", "]"}]}], "}"}]}], "]"}], 
      "]"}], "]"}], "//.", "scalars"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8513148556570797`*^9, 3.851314905921215*^9}, {
   3.851314975173613*^9, 3.851314975387897*^9}, {3.85131505034558*^9, 
   3.851315070130357*^9}, {3.851315176112998*^9, 3.851315181479403*^9}, {
   3.851315253096435*^9, 3.851315257713922*^9}, 3.851316459459792*^9, 
   3.851316624324905*^9, 3.852200532645584*^9, 3.852201252984548*^9, {
   3.852432754609556*^9, 3.852432755261867*^9}, {3.8648810663165627`*^9, 
   3.864881109058832*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"3841c6ce-d510-474f-aa08-e39a9f2a6753"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/IBPreduction.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", 
    RowBox[{"\"\<* Generated by \>\"", "<>", 
     RowBox[{"FileNameTake", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", "\"\<id \>\"", ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"IBPreduction", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], ",", "\"\< = \>\"", 
      ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"IBPreduction", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}], ",", 
      "\"\<;\\n\\n\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"Length", "[", "IBPreduction", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8513289707918987`*^9, 3.85132903220849*^9}, {
   3.851329092928596*^9, 3.851329238290442*^9}, {3.851329295791916*^9, 
   3.851329427476736*^9}, 3.851329478760659*^9, {3.851329658610557*^9, 
   3.851329658699752*^9}, {3.85133033522237*^9, 3.8513303359638453`*^9}, {
   3.851348199283114*^9, 3.851348286501163*^9}, {3.851348350095848*^9, 
   3.851348488634595*^9}, {3.851348564987701*^9, 3.851348572302719*^9}, {
   3.851348622013184*^9, 3.851348622025236*^9}, {3.851348702731555*^9, 
   3.851348705227811*^9}, {3.851348848420809*^9, 3.851348870619925*^9}, {
   3.851835637666329*^9, 3.851835638192842*^9}, {3.8519459283506393`*^9, 
   3.8519459297581987`*^9}, {3.851946403929805*^9, 3.851946409394755*^9}, {
   3.852200677748415*^9, 3.8522007817904577`*^9}, {3.8522594499431343`*^9, 
   3.852259451849128*^9}, 3.852260160788229*^9, {3.8524327569507113`*^9, 
   3.8524327611829433`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"bff10280-c82f-4107-802a-f16c318e9ade"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Redefinition of the LCGBox integral using a dimensional-shift relation: \
form/dimShiftLCGBox.h\
\>", "Section",
 CellChangeTimes->{{3.85220829120037*^9, 3.852208317333632*^9}, {
  3.8522122340073967`*^9, 3.85221223420719*^9}, {3.8522601824316177`*^9, 
  3.852260203904973*^9}, {3.8522796730158043`*^9, 
  3.852279676948742*^9}},ExpressionUUID->"23749339-3730-49fd-8593-\
e25e0c38d4e6"],

Cell["Requires the definitions from the IBPreduction block above", "Text",
 CellChangeTimes->{{3.852433328325923*^9, 
  3.852433345903667*^9}},ExpressionUUID->"11f03654-2627-4654-8326-\
913957af694f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IBPkiraDeep", "=", 
   RowBox[{
   "Get", "[", "\"\<IBPreduction/results/LCGBox/kira_31_1_1.m\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.852127477660981*^9, 3.8521274901731567`*^9}, {
  3.852127529345234*^9, 3.8521275409892473`*^9}, {3.852208341681493*^9, 
  3.852208364469241*^9}, {3.85225961179845*^9, 3.852259612029537*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"1cda3679-84ac-4034-9012-0af9e35ac5a5"],

Cell[TextData[{
 "Despite the presence of the eikonal propagator, the same dimensional-shift \
relations hold as in the ordinary case, see for example ",
 ButtonBox["Weinzierl's lecture notes",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/2201.03593"], None},
  ButtonNote->"https://arxiv.org/abs/2201.03593"],
 " Eq. (6.34) p. 162 (there is an additional minus sign, since Weinzierl uses \
Euclidean propagators). The proof relies on the Feynman parameter \
representation."
}], "Text",
 CellChangeTimes->{{3.852204161698173*^9, 3.852204213879403*^9}, {
  3.852204249716268*^9, 3.852204292539916*^9}, {3.852204347612527*^9, 
  3.852204366271002*^9}, {3.852205479800362*^9, 3.852205502214253*^9}, {
  3.852259474596305*^9, 
  3.852259496770771*^9}},ExpressionUUID->"e3da425a-383e-480e-8fbd-\
5ac1ca073bf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"appendDim", "[", "d_", "]"}], ":=", 
   RowBox[{
    RowBox[{"LCGBox", "[", "pows__", "]"}], "->", 
    RowBox[{"LCGBox", "[", 
     RowBox[{"pows", ",", "d"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dropDim", "[", "d_", "]"}], ":=", 
   RowBox[{
    RowBox[{"LCGBox", "[", 
     RowBox[{"pows__", ",", "d"}], "]"}], "->", 
    RowBox[{"LCGBox", "[", "pows", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.85220491892505*^9, 3.852204936883943*^9}, {
  3.852205132674024*^9, 3.852205148474333*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"524bfd1e-7c6e-4c71-9c0b-d44823b043e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimShiftRelation", "[", "powers__", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"{", "powers", "}"}], "]"}]}], ",", "shifted", ",", "pows"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"shifted", "=", 
      RowBox[{"-", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "powers", "}"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"LCGBox", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "powers", "}"}], "+", 
              RowBox[{"UnitVector", "[", 
               RowBox[{"n", ",", "i"}], "]"}]}], ")"}]}], ")"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"LCGBox", "[", 
         RowBox[{"powers", ",", 
          RowBox[{"d", "-", "2"}]}], "]"}], "==", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"shifted", "/.", "IBPkiraDeep"}], "/.", 
          RowBox[{"appendDim", "[", "d", "]"}]}], ")"}]}], ")"}], "/.", 
      RowBox[{"d", "->", 
       RowBox[{"d", "+", "2"}]}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.852129003866295*^9, 3.8521291220991*^9}, {
   3.8521291999410887`*^9, 3.852129244187909*^9}, {3.852129356447723*^9, 
   3.852129392746334*^9}, {3.852129458369733*^9, 3.852129498389093*^9}, {
   3.852129533261632*^9, 3.852129609579095*^9}, {3.852129649790269*^9, 
   3.852129669823691*^9}, 3.852129752676662*^9, 3.852129995346093*^9, {
   3.852130179520197*^9, 3.852130216849216*^9}, {3.852130537897194*^9, 
   3.8521305465075417`*^9}, 3.852203664468276*^9, {3.852204107683573*^9, 
   3.852204145709218*^9}, {3.852204464276606*^9, 3.8522046301826267`*^9}, {
   3.852204934470153*^9, 3.852204961999722*^9}, {3.852249100038965*^9, 
   3.85224910354008*^9}, 3.852259476946019*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"cae38497-91b3-4c28-b6cb-84b846149e59"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mastersLCGBox", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Last", "/@", "IBPkiraDeep"}], ",", 
      RowBox[{"LCGBox", "[", "__", "]"}], ",", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.852203514676632*^9, 3.852203548465509*^9}, 
   3.852203587271751*^9, {3.8522036345331287`*^9, 3.8522036382089453`*^9}, {
   3.8522046783225822`*^9, 3.852204691843379*^9}, 3.852205202962191*^9, {
   3.852208382024802*^9, 3.8522083907852573`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"c7f1bb95-68b4-4c50-8a2d-735e2b5ec2cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimShiftRelations", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"First", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"dimShiftRelation", "@@@", "mastersLCGBox"}], ",", 
       RowBox[{
        RowBox[{"mastersLCGBox", "/.", 
         RowBox[{"appendDim", "[", 
          RowBox[{"d", "+", "2"}], "]"}]}], "/.", 
        RowBox[{
         RowBox[{"LCGBox", "[", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
           RowBox[{"d", "+", "2"}]}], "]"}], "->", 
         RowBox[{"LCGBox", "[", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "d"}], 
          "]"}]}]}]}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.852204697217578*^9, 3.8522047771013393`*^9}, {
   3.852204840187997*^9, 3.852204880522781*^9}, {3.8522049871828213`*^9, 
   3.852205004667591*^9}, {3.852205167526229*^9, 3.852205171548798*^9}, {
   3.8522060055193777`*^9, 3.852206006431745*^9}, 3.852206037164723*^9, {
   3.852207028035225*^9, 3.8522070475874233`*^9}, 3.85220708778885*^9, {
   3.852212355949144*^9, 3.852212361783723*^9}, {3.8522594780307913`*^9, 
   3.8522594790607758`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"8c3e41e5-c457-4d6b-a5a9-b474fe1bc21a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimShiftRelations", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"LCGBoxIntegrand", "[", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "]"}], "->", 
     RowBox[{"format", "[", 
      RowBox[{"InsertLCGBoxIntegrands", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"LCGBox", "[", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "d"}], 
          "]"}], "/.", "dimShiftRelations"}], "/.", 
        RowBox[{"dropDim", "[", "d", "]"}]}], "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s12", "->", 
       RowBox[{"2", 
        RowBox[{"S", "[", 
         RowBox[{"p1", ",", "p2"}], "]"}]}]}], ",", 
      RowBox[{"s13", "->", 
       RowBox[{"2", 
        RowBox[{"S", "[", 
         RowBox[{"p1", ",", "p3"}], "]"}]}]}], ",", 
      RowBox[{"s23", "->", 
       RowBox[{"2", 
        RowBox[{"S", "[", 
         RowBox[{"p2", ",", "p3"}], "]"}]}]}], ",", 
      RowBox[{"p1n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p1", ",", "n"}], "]"}]}], ",", 
      RowBox[{"p2n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p2", ",", "n"}], "]"}]}], ",", 
      RowBox[{"p3n", "->", 
       RowBox[{"S", "[", 
        RowBox[{"p3", ",", "n"}], "]"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.852211555817728*^9, 3.852211556582246*^9}, {
   3.852212260452691*^9, 3.852212289512762*^9}, {3.852212376061118*^9, 
   3.8522124078836718`*^9}, {3.852212440594357*^9, 3.85221245114573*^9}, 
   3.852212500123064*^9, 3.852212554510138*^9, {3.85221278440136*^9, 
   3.852212802136244*^9}, {3.8522594799956293`*^9, 3.852259481379963*^9}, {
   3.861703780610271*^9, 3.8617037837082443`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"60f6d39d-24b5-4c27-b331-feac01791585"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimShiftRelations", "=", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"dimShiftRelations", "/.", 
         RowBox[{"permutations", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "permutations", "]"}]}], "}"}]}], "]"}], 
      "]"}], "]"}], "//.", "scalars"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.852212342165596*^9, 3.852212346656472*^9}, {
   3.8522125362682543`*^9, 3.852212557038788*^9}, 3.852212626859199*^9, {
   3.8522594824802628`*^9, 3.852259483478939*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"cfaab4db-d305-453c-b6be-f69627bcc710"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/dimShiftLCGBox.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", 
    RowBox[{"\"\<* Generated by \>\"", "<>", 
     RowBox[{"FileNameTake", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", "\"\<id \>\"", ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"dimShiftRelations", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], ",", "\"\< = \>\"", 
      ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"dimShiftRelations", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}], ",", 
      "\"\<;\\n\\n\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", 
      RowBox[{"Length", "[", "dimShiftRelations", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8513289707918987`*^9, 3.85132903220849*^9}, {
   3.851329092928596*^9, 3.851329238290442*^9}, {3.851329295791916*^9, 
   3.851329427476736*^9}, 3.851329478760659*^9, {3.851329658610557*^9, 
   3.851329658699752*^9}, {3.85133033522237*^9, 3.8513303359638453`*^9}, {
   3.851348199283114*^9, 3.851348286501163*^9}, {3.851348350095848*^9, 
   3.851348488634595*^9}, {3.851348564987701*^9, 3.851348572302719*^9}, {
   3.851348622013184*^9, 3.851348622025236*^9}, {3.851348702731555*^9, 
   3.851348705227811*^9}, {3.851348848420809*^9, 3.851348870619925*^9}, {
   3.851835637666329*^9, 3.851835638192842*^9}, {3.8519459283506393`*^9, 
   3.8519459297581987`*^9}, {3.851946403929805*^9, 3.851946409394755*^9}, {
   3.852200677748415*^9, 3.8522007817904577`*^9}, {3.8522126789303913`*^9, 
   3.8522127079275837`*^9}, {3.852259458548715*^9, 3.8522594875748672`*^9}, 
   3.852260165210861*^9, {3.852260206644783*^9, 3.852260207762026*^9}, {
   3.85227702342698*^9, 3.852277025947955*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"2d4cfad2-6366-41d7-a3fa-da287647e994"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Four-dimensional projection of spin structures: \
form/{Gamma,Epsilon,Chain}4Dprojection.h\
\>", "Section",
 CellChangeTimes->{{3.8524324475027227`*^9, 3.852432467045443*^9}, {
  3.852434320223023*^9, 
  3.852434334989778*^9}},ExpressionUUID->"79e4df47-283e-4c98-b0d3-\
9abe5ebd7330"],

Cell["\<\
The projection relies on the fact that the momenta p1,p2,p3,n form a basis in \
four dimensions\
\>", "Text",
 CellChangeTimes->{{3.852432472821526*^9, 3.852432493884725*^9}, 
   3.861703787982051*^9},ExpressionUUID->"2177c41f-5bbb-48eb-a8ed-\
30cfb065a847"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/Gamma4Dprojection.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", 
    RowBox[{"\"\<* Generated by \>\"", "<>", 
     RowBox[{"FileNameTake", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#do i=1,3\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "file", ",", "\"\<id once G(mu?{mu,nu1,nu2,mu1,mu2,mu3}) = \>\"", ",", 
    RowBox[{"FORMString", "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ReduceTensor", "[", 
         RowBox[{"x", ",", 
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2", ",", "p3", ",", "n"}], "}"}], ",", 
          RowBox[{"{", "mu", "}"}], ",", "scalars"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"S", "[", 
          RowBox[{"x", ",", "p_"}], "]"}], "->", 
         RowBox[{"G", "[", "p", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"den", "[", "_", "]"}], ",", 
         RowBox[{"G", "[", "_", "]"}], ",", 
         RowBox[{"_", "[", "mu", "]"}]}], "}"}], ",", "Factor"}], "]"}], 
     "]"}], ",", "\"\<;\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#enddo\\n\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#do i=0,3\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<id G(E`i') = \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"FORMString", "[", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ReduceTensor", "[", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2", ",", "p3", ",", "n"}], "}"}], ",", 
            RowBox[{"{", "mu", "}"}], ",", "scalars"}], "]"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"x", ",", "p_"}], "]"}], "->", 
             RowBox[{"G", "[", "p", "]"}]}], ",", 
            RowBox[{
             RowBox[{"n", "[", "mu", "]"}], "->", "0"}], ",", 
            RowBox[{
             RowBox[{"p_", "[", "mu", "]"}], "->", 
             RowBox[{"Ei", ".", "p"}]}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"den", "[", "_", "]"}], ",", 
           RowBox[{"G", "[", "_", "]"}], ",", 
           RowBox[{"Ei", ".", "_"}]}], "}"}], ",", "Factor"}], "]"}], "]"}], 
      ",", 
      RowBox[{"\"\<Ei\>\"", "->", "\"\<E`i'\>\""}]}], "]"}], ",", 
    "\"\<;\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#enddo\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8523525249973297`*^9, 3.852352604792083*^9}, {
   3.852352651058563*^9, 3.852352652125813*^9}, {3.85235282793326*^9, 
   3.8523529225901117`*^9}, {3.852352954829752*^9, 3.8523529566238317`*^9}, {
   3.852353434316451*^9, 3.8523534564823713`*^9}, {3.852353526691073*^9, 
   3.852353617408407*^9}, {3.852353697570417*^9, 3.852353703757049*^9}, {
   3.852353773862933*^9, 3.852353776769442*^9}, {3.8523622756030903`*^9, 
   3.8523623766687603`*^9}, {3.852362502188239*^9, 3.852362557348981*^9}, 
   3.85236258922906*^9, {3.852363141997509*^9, 3.8523631566738873`*^9}, {
   3.852363245359284*^9, 3.852363246266233*^9}, {3.8523861662001038`*^9, 
   3.852386251229177*^9}, {3.852386370046164*^9, 3.8523864637916203`*^9}, {
   3.852388951606222*^9, 3.852388959918552*^9}, {3.8523894388662157`*^9, 
   3.852389441865073*^9}, 3.852432578963766*^9, {3.852432927589963*^9, 
   3.852432950849551*^9}, {3.8617037977380323`*^9, 3.861703799038846*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"92fdf497-200e-45f4-8448-80696c19bf19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/Epsilon4Dprojection.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", 
    RowBox[{"\"\<* Generated by \>\"", "<>", 
     RowBox[{"FileNameTake", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#do i=0,3\\n\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#do j={`i'+1},3\\n\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<id E`i'.E`j'= \>\"", ",", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"FORMString", "[", 
       RowBox[{"Collect", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"ReduceTensor", "[", 
             RowBox[{"x", ",", 
              RowBox[{"{", 
               RowBox[{"p1", ",", "p2", ",", "p3", ",", "n"}], "}"}], ",", 
              RowBox[{"{", "mu", "}"}], ",", "scalars"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"S", "[", 
              RowBox[{"x", ",", "p_"}], "]"}], "->", 
             RowBox[{"Ei", ".", "p"}]}]}], "/.", 
           RowBox[{
            RowBox[{"Ei", ".", "n"}], "->", "0"}]}], "/.", 
          RowBox[{
           RowBox[{"p_", "[", "mu", "]"}], "->", 
           RowBox[{"Ej", ".", "p"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"den", "[", "_", "]"}], ",", 
           RowBox[{"Ei", ".", "_"}], ",", 
           RowBox[{"Ej", ".", "_"}]}], "}"}], ",", "Factor"}], "]"}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<Ei\>\"", "->", "\"\<E`i'\>\""}], ",", 
        RowBox[{"\"\<Ej\>\"", "->", "\"\<E`j'\>\""}]}], "}"}]}], "]"}], ",", 
    "\"\<;\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#enddo\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#enddo\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.852352700637372*^9, 3.852352768349818*^9}, {
   3.852352901075032*^9, 3.852353055010298*^9}, 3.852353180385202*^9, {
   3.8523533657794228`*^9, 3.852353403106111*^9}, {3.852362809532662*^9, 
   3.852362863580739*^9}, {3.852362973946355*^9, 3.852362996413754*^9}, {
   3.852363069282893*^9, 3.85236307018946*^9}, {3.852363125848669*^9, 
   3.852363126600747*^9}, {3.85236316969844*^9, 3.852363169945264*^9}, {
   3.852363200622037*^9, 3.85236326012676*^9}, {3.85236338755162*^9, 
   3.852363505651512*^9}, {3.852363589201028*^9, 3.852363591747196*^9}, {
   3.852386272327661*^9, 3.852386327549136*^9}, 3.852386444760579*^9, 
   3.852389477395585*^9, 3.85243258127308*^9, {3.852432943129788*^9, 
   3.8524329528720303`*^9}, {3.861703810871323*^9, 3.861703818202902*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"e80b6ad6-9a82-4c6b-87b9-e5709e021088"],

Cell["\<\
The projection of the chains is precomputed here in order to achieve fast \
substitution in the splitting functions. If the splitting functions have not \
been computed yet, then a list is provided from a previous calculation.  \
Otherwise, one can rerun this block once the splitting functions have been \
evaluated.\
\>", "Text",
 CellChangeTimes->{{3.852433945273028*^9, 
  3.852434065680457*^9}},ExpressionUUID->"b0620a8e-79ba-46cc-9e35-\
a9ed1be25443"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"splittings", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<qqpqpbar1l\>\"", ",", "\"\<qqqbar1l\>\"", ",", "\"\<qgg1l\>\"", ",", 
     "\"\<gqqbar1l\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"files", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\"\<results/\>\"", "<>", "#", "<>", "\"\<.m\>\""}], ")"}], 
     "&"}], "/@", "splittings"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chains", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"FileExistsQ", "/@", "files"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Get", "/@", "files"}], ";", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Symbol", "/@", "splittings"}], ",", 
         RowBox[{"Chain", "[", "__", "]"}], ",", 
         RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "E2", "]"}], ",", "U0"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "E3", "]"}], ",", "U0"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p2", "]"}], ",", "U0"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p3", "]"}], ",", "U0"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"E2", ",", "E3", ",", "p3"}], "]"}], ",", "U0"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "E2", ",", "E3"}], "]"}], ",", "U0"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "E2", ",", "p3"}], "]"}], ",", "U0"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "E3", ",", "p3"}], "]"}], ",", "U0"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "E0", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "E1", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "p1", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "n", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"E1", ",", "E0", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "E0", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "E1", ",", "E0"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "E1", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "mu", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p2", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", "p1", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p2", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", "n", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p3", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", "p1", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", "p3", "]"}], ",", "U0", ",", "UBar2", ",", 
         RowBox[{"G", "[", "n", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"mu1", ",", "mu2", ",", "mu3"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"mu1", ",", "mu2", ",", "mu3"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "n"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "nu1", ",", "nu2"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "mu", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "mu", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "mu", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "nu1", ",", "nu2"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "n"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "nu1", ",", "nu2"}], "]"}], ",", "U0", ",", 
         "UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "nu1", ",", "nu2"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "mu", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "p1", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", "p2", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "p1", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", "n", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "p3", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", "p2", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", "p3", "]"}], ",", "U0", ",", "UBar1", ",", 
         RowBox[{"G", "[", "n", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"mu1", ",", "mu2", ",", "mu3"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"mu1", ",", "mu2", ",", "mu3"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "n"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "nu1", ",", "nu2"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "mu", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", "mu", "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "mu", ",", "p3"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "mu", ",", "n"}], "]"}], ",", "V3"}], "]"}], ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "nu1", ",", "nu2"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"nu1", ",", "nu2", ",", "n"}], "]"}], ",", "V3"}], "]"}], 
       ",", 
       RowBox[{"Chain", "[", 
        RowBox[{"UBar2", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p1", ",", "nu1", ",", "nu2"}], "]"}], ",", "U0", ",", 
         "UBar1", ",", 
         RowBox[{"G", "[", 
          RowBox[{"p2", ",", "nu1", ",", "nu2"}], "]"}], ",", "V3"}], "]"}]}],
       "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.852298959761948*^9, 3.852298990367279*^9}, {
  3.852301895755143*^9, 3.852301899364708*^9}, {3.852302008561895*^9, 
  3.8523020362707853`*^9}, {3.852302267839405*^9, 3.852302272058333*^9}, {
  3.8523866112388372`*^9, 3.8523866179835033`*^9}, {3.852389786307694*^9, 
  3.8523898058607683`*^9}, {3.852432683085578*^9, 3.852432684473237*^9}, {
  3.852433105928583*^9, 3.852433289144909*^9}, {3.852433568056368*^9, 
  3.8524337626709547`*^9}, {3.852433833413266*^9, 3.852433849833997*^9}, {
  3.85304406077409*^9, 3.853044070368987*^9}, {3.861703846405292*^9, 
  3.861703866360327*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"34d774db-5b5e-4060-a335-25b392ddcb24"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/chains.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<#define nchains \\\"\>\"", ",", 
    RowBox[{"Length", "[", "chains", "]"}], ",", "\"\<\\\"\\n\\n\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{
     "file", ",", "\"\<l chain\>\"", ",", "i", ",", "\"\< = \>\"", ",", 
      RowBox[{"FORMString", "[", 
       RowBox[{"chains", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\\n\\n\>\""}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "chains", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Run", "[", "\"\<form form/Chain4Dprojection.frm\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "chains.m"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DeleteFile", "[", 
   RowBox[{"{", 
    RowBox[{"\"\<form/chains.h\>\"", ",", "\"\<chains.m\>\""}], "}"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.852299010399933*^9, 3.852299049761174*^9}, {
   3.852299102159676*^9, 3.8522991040243597`*^9}, {3.852299272572946*^9, 
   3.8522992771764507`*^9}, 3.85230122432131*^9, 3.8523018301415653`*^9, {
   3.852302426586987*^9, 3.852302426973178*^9}, {3.852302525732888*^9, 
   3.85230252688402*^9}, {3.852386036004244*^9, 3.852386037217594*^9}, {
   3.8523866218078403`*^9, 3.852386625590691*^9}, {3.852386674470571*^9, 
   3.8523866857375317`*^9}, {3.852389756320841*^9, 3.852389761861964*^9}, {
   3.852389810577079*^9, 3.852389822653895*^9}, 3.8524326814457912`*^9, {
   3.8524330081344547`*^9, 3.8524330777868767`*^9}, {3.8524359212679243`*^9, 
   3.852435928575418*^9}, 3.852436010682953*^9, {3.852436342286882*^9, 
   3.8524363464030237`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"5dde29d6-82b1-4ca6-b844-9ef686505b7d"],

Cell[BoxData[
 TemplateBox[{
  "Get", "noopen", 
   "\"Cannot open \\!\\(\\*RowBox[{\\\"\\\\\\\"chains.m\\\\\\\"\\\"}]\\).\"", 
   2, 74, 1, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861718418532515*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"a9020f33-64db-4510-aeb0-4d86df50fb6b"],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.861718418568507*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"558e0570-d3ec-4e2f-bad4-d99a437f3060"],

Cell[BoxData[
 TemplateBox[{
  "DeleteFile", "fdnfnd", 
   "\"Directory or file \
\\!\\(\\*RowBox[{\\\"\\\\\\\"chains.m\\\\\\\"\\\"}]\\) not found.\"", 2, 75, 
   2, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861718418609309*^9},
 CellLabel->
  "During evaluation of \
In[69]:=",ExpressionUUID->"eb086fd4-02cf-4246-967f-0d2c31c3c3df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"file", "=", 
   RowBox[{"OpenWrite", "[", "\"\<form/Chain4Dprojection.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", 
    RowBox[{"\"\<* Generated by \>\"", "<>", 
     RowBox[{"FileNameTake", "[", 
      RowBox[{"NotebookFileName", "[", "]"}], "]"}], "<>", 
     "\"\<\\n\\n\>\""}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"WriteString", "[", 
    RowBox[{"file", ",", "\"\<id \>\"", ",", 
     RowBox[{"FORMString", "[", 
      RowBox[{"chains", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\< = \>\"", ",", 
     RowBox[{"FORMString", "[", 
      RowBox[{"chains4D", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\\n\\n\>\""}], "]"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Length", "[", "chains", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.852390246707571*^9, 3.85239029346461*^9}, {
   3.852390329817904*^9, 3.852390391959571*^9}, {3.852390442530559*^9, 
   3.8523904760856*^9}, 3.8524326159788322`*^9, {3.852432958447727*^9, 
   3.852432962101955*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"1ae6d899-bfd0-4b57-99ac-199b4c16e940"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"chains4D\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 78, 3, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861718418726872*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"8e8f1a54-0bc9-47f1-b857-78c912e5f2c2"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"chains4D\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 78, 4, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861718418734823*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"695a145a-e90a-4cbe-9b14-d856bcf831bf"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partd", 
   "\"Part specification \\!\\(\\*RowBox[{\\\"chains4D\\\", \\\"\
\[LeftDoubleBracket]\\\", \\\"3\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is \
longer than depth of object.\"", 2, 78, 5, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.86171841873953*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"ec87f5e9-60fb-459f-ba29-0229fb724ba6"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 78, 6, 28551222674695214760, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.861718418743243*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"001da32d-c971-4f3d-b71c-f1cc2a278d15"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 876},
WindowMargins->{{1440, Automatic}, {0, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"52dafcc7-3c47-42b4-a5bb-e58df419bd49"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 172, 2, 29, "Input",ExpressionUUID->"d1ef815d-3661-4497-8557-0d2a666e40d3"],
Cell[CellGroupData[{
Cell[755, 26, 275, 5, 29, "Input",ExpressionUUID->"d729a100-b25e-4533-b309-ff25a82f608c"],
Cell[1033, 33, 678, 10, 33, "Output",ExpressionUUID->"39471319-b1c6-4940-a77c-9e75e9c7d406"]
}, Open  ]],
Cell[1726, 46, 508, 10, 29, "Input",ExpressionUUID->"565ef35d-b762-4ee2-b85c-81983d97854c"],
Cell[2237, 58, 243, 4, 29, "Input",ExpressionUUID->"5118d361-6ccf-47e4-84d9-79b511631a74"],
Cell[CellGroupData[{
Cell[2505, 66, 442, 7, 29, "Input",ExpressionUUID->"89110cd7-09c9-49e4-8ebd-53ece94cf413"],
Cell[CellGroupData[{
Cell[2972, 77, 1559, 23, 23, "Print",ExpressionUUID->"c1063591-7d66-411c-93f2-b1e03d434f77"],
Cell[4534, 102, 1534, 23, 23, "Print",ExpressionUUID->"662d13d9-2ec9-41e4-bc42-0026ac81c8a7"],
Cell[6071, 127, 1550, 23, 23, "Print",ExpressionUUID->"dd6d5ec4-7a94-4ad9-a4dd-c10f782b5879"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7670, 156, 156, 3, 68, "Section",ExpressionUUID->"bb4022c5-ce3d-4c48-b7bc-92147fd4273f"],
Cell[7829, 161, 12751, 337, 257, "Input",ExpressionUUID->"cc9e95fe-805b-4206-b3b9-5b90da03658e"],
Cell[20583, 500, 1369, 29, 29, "Input",ExpressionUUID->"29dd5750-5c61-4b69-b034-3ddba8e42fcd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21989, 534, 435, 8, 68, "Section",ExpressionUUID->"7dbbcaa8-da25-447e-93d7-6616b8f5b7de"],
Cell[22427, 544, 679, 19, 29, "Input",ExpressionUUID->"8614b129-7024-42f4-ae6e-d11089432f07"],
Cell[23109, 565, 6395, 118, 339, "Input",ExpressionUUID->"9ce4f695-9c2f-461d-bb30-0b7b4a80cfd6"],
Cell[29507, 685, 56099, 1189, 2703, "Input",ExpressionUUID->"e7e987b8-5e48-4a91-8f6e-d9304df70d40"],
Cell[85609, 1876, 362, 7, 29, "Input",ExpressionUUID->"85515272-a1ad-4ee7-8772-8ed116b43bd7"],
Cell[85974, 1885, 1070, 21, 113, "Input",ExpressionUUID->"b02601c7-4548-4fb4-acae-4d33d14a0b1e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87081, 1911, 338, 7, 68, "Section",ExpressionUUID->"63beb8e4-a9fe-4f37-95d3-612c238d1f55"],
Cell[87422, 1920, 6929, 147, 525, "Input",ExpressionUUID->"68db3d0c-cf7b-4e31-98c7-805e1e0e224a"],
Cell[94354, 2069, 6077, 135, 278, "Input",ExpressionUUID->"68ab178b-1a0a-41b8-938e-cea59f957887"],
Cell[CellGroupData[{
Cell[100456, 2208, 794, 17, 29, "Input",ExpressionUUID->"888d3153-5aba-4348-bb37-9ece67ecd8f1"],
Cell[CellGroupData[{
Cell[101275, 2229, 425, 10, 23, "Print",ExpressionUUID->"c8a4e8df-3221-4c16-b662-315590fb277e"],
Cell[101703, 2241, 366, 8, 23, "Print",ExpressionUUID->"29ef9edb-daf8-4324-8a27-5866f5a1dcab"],
Cell[102072, 2251, 673, 18, 38, "Print",ExpressionUUID->"fccf2585-e8b4-4ab5-9134-9d828eac8838"]
}, Open  ]]
}, Open  ]],
Cell[102772, 2273, 147, 3, 51, "Input",ExpressionUUID->"cb047328-fe89-4f0d-b966-1216bd069229"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102956, 2281, 471, 9, 68, "Section",ExpressionUUID->"a810eb9d-2b1c-4136-b5ef-be189b974b84"],
Cell[103430, 2292, 353, 9, 29, "Input",ExpressionUUID->"e2efb87d-3c62-4629-8449-9031a3c018a4"],
Cell[103786, 2303, 5882, 130, 174, "Input",ExpressionUUID->"16f21213-0346-4c54-bf46-e28bb4ac3c46"],
Cell[CellGroupData[{
Cell[109693, 2437, 2567, 50, 29, "Input",ExpressionUUID->"751eeeec-7a65-4e95-a529-ea6f0983d144"],
Cell[CellGroupData[{
Cell[112285, 2491, 711, 11, 23, "Print",ExpressionUUID->"3f9979c5-91cf-4b21-94c9-9f16d5b320e4"],
Cell[112999, 2504, 711, 11, 23, "Print",ExpressionUUID->"875fb775-46a9-4058-b7ba-a873f0f45aed"],
Cell[113713, 2517, 711, 11, 23, "Print",ExpressionUUID->"1809f279-ee39-4de2-bf19-ed5326951878"],
Cell[114427, 2530, 711, 11, 23, "Print",ExpressionUUID->"28f99c81-6efc-4891-a9b4-4ee68b582dbd"]
}, Open  ]]
}, Open  ]],
Cell[115165, 2545, 3988, 91, 195, "Input",ExpressionUUID->"4593ffe4-c589-4a8b-bbcc-d565f0fcb40e"],
Cell[119156, 2638, 1161, 31, 71, "Input",ExpressionUUID->"f3f74ee0-9231-4143-a3e9-4d8b53bb17ec"],
Cell[120320, 2671, 1779, 36, 92, "Input",ExpressionUUID->"d78ef719-2ccd-42b3-8479-de7d1f3380d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122136, 2712, 340, 5, 68, "Section",ExpressionUUID->"181067b8-b76e-4d37-8cc7-e5918c4172a0"],
Cell[122479, 2719, 283, 6, 29, "Input",ExpressionUUID->"86de1129-d184-4eac-a91b-d5b734b9d961"],
Cell[122765, 2727, 693, 13, 29, "Input",ExpressionUUID->"baf84354-a487-42ec-a2b7-b8b6c7b35f64"],
Cell[123461, 2742, 3595, 75, 113, "Input",ExpressionUUID->"a857560c-912b-4347-a6dd-f2e2c7a81112"],
Cell[127059, 2819, 1655, 46, 71, "Input",ExpressionUUID->"5b4c7558-8c15-4db1-8b54-23feb6128f84"],
Cell[128717, 2867, 2658, 75, 92, "Input",ExpressionUUID->"3a43d2a1-105d-4e6d-88b0-1c862f1c3bb0"],
Cell[131378, 2944, 2379, 63, 113, "Input",ExpressionUUID->"3841c6ce-d510-474f-aa08-e39a9f2a6753"],
Cell[133760, 3009, 2122, 46, 92, "Input",ExpressionUUID->"bff10280-c82f-4107-802a-f16c318e9ade"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135919, 3060, 396, 8, 68, "Section",ExpressionUUID->"23749339-3730-49fd-8593-e25e0c38d4e6"],
Cell[136318, 3070, 200, 3, 35, "Text",ExpressionUUID->"11f03654-2627-4654-8326-913957af694f"],
Cell[136521, 3075, 455, 9, 29, "Input",ExpressionUUID->"1cda3679-84ac-4034-9012-0af9e35ac5a5"],
Cell[136979, 3086, 834, 17, 58, "Text",ExpressionUUID->"e3da425a-383e-480e-8fbd-5ac1ca073bf3"],
Cell[137816, 3105, 664, 17, 51, "Input",ExpressionUUID->"524bfd1e-7c6e-4c71-9c0b-d44823b043e3"],
Cell[138483, 3124, 2162, 53, 51, "Input",ExpressionUUID->"cae38497-91b3-4c28-b6cb-84b846149e59"],
Cell[140648, 3179, 630, 13, 29, "Input",ExpressionUUID->"c7f1bb95-68b4-4c50-8a2d-735e2b5ec2cc"],
Cell[141281, 3194, 1258, 26, 29, "Input",ExpressionUUID->"8c3e41e5-c457-4d6b-a5a9-b474fe1bc21a"],
Cell[142542, 3222, 1778, 44, 51, "Input",ExpressionUUID->"60f6d39d-24b5-4c27-b331-feac01791585"],
Cell[144323, 3268, 762, 18, 29, "Input",ExpressionUUID->"cfaab4db-d305-453c-b6be-f69627bcc710"],
Cell[145088, 3288, 2234, 47, 92, "Input",ExpressionUUID->"2d4cfad2-6366-41d7-a3fa-da287647e994"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147359, 3340, 294, 7, 68, "Section",ExpressionUUID->"79e4df47-283e-4c98-b0d3-9abe5ebd7330"],
Cell[147656, 3349, 268, 6, 35, "Text",ExpressionUUID->"2177c41f-5bbb-48eb-a8ed-30cfb065a847"],
Cell[147927, 3357, 4189, 99, 257, "Input",ExpressionUUID->"92fdf497-200e-45f4-8448-80696c19bf19"],
Cell[152119, 3458, 3202, 75, 216, "Input",ExpressionUUID->"e80b6ad6-9a82-4c6b-87b9-e5709e021088"],
Cell[155324, 3535, 467, 9, 58, "Text",ExpressionUUID->"b0620a8e-79ba-46cc-9e35-a9ed1be25443"],
Cell[155794, 3546, 10707, 256, 360, "Input",ExpressionUUID->"34d774db-5b5e-4060-a335-25b392ddcb24"],
Cell[CellGroupData[{
Cell[166526, 3806, 2072, 46, 154, "Input",ExpressionUUID->"5dde29d6-82b1-4ca6-b844-9ef686505b7d"],
Cell[168601, 3854, 360, 9, 22, "Message",ExpressionUUID->"a9020f33-64db-4510-aeb0-4d86df50fb6b"],
Cell[168964, 3865, 155, 2, 33, "Output",ExpressionUUID->"558e0570-d3ec-4e2f-bad4-d99a437f3060"],
Cell[169122, 3869, 385, 10, 22, "Message",ExpressionUUID->"eb086fd4-02cf-4246-967f-0d2c31c3c3df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169544, 3884, 1340, 33, 92, "Input",ExpressionUUID->"1ae6d899-bfd0-4b57-99ac-199b4c16e940"],
Cell[170887, 3919, 454, 10, 22, "Message",ExpressionUUID->"8e8f1a54-0bc9-47f1-b857-78c912e5f2c2"],
Cell[171344, 3931, 454, 10, 22, "Message",ExpressionUUID->"695a145a-e90a-4cbe-9b14-d856bcf831bf"],
Cell[171801, 3943, 453, 10, 22, "Message",ExpressionUUID->"ec87f5e9-60fb-459f-ba29-0229fb724ba6"],
Cell[172257, 3955, 449, 10, 22, "Message",ExpressionUUID->"001da32d-c971-4f3d-b71c-f1cc2a278d15"]
}, Open  ]]
}, Open  ]]
}
]
*)

